(function(n){"use strict";n.IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.IntelliFactory.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7;b=a.PrettyTodo=a.PrettyTodo||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.UI=d.UI||{};f=e.Client=e.Client||{};g=f.Templates=f.Templates||{};h=d.Obj=d.Obj||{};i=e.Doc=e.Doc||{};j=d.JavaScript=d.JavaScript||{};k=j.Pervasives=j.Pervasives||{};l=a.StartupCode$todo$Client=a.StartupCode$todo$Client||{};m=d.Operators=d.Operators||{};n=a.EventTarget;o=a.Node;p=j.JS=j.JS||{};q=d.Collections=d.Collections||{};r=q.Dictionary=q.Dictionary||{};s=d.Unchecked=d.Unchecked||{};t=e.RouteMap=e.RouteMap||{};u=c.Filter=c.Filter||{};v=d.List=d.List||{};w=v.T=v.T||{};x=e.ListModel=e.ListModel||{};y=c.TodoItem=c.TodoItem||{};z=e.Var$1=e.Var$1||{};A=e.AttrModule=e.AttrModule||{};B=e.Var=e.Var||{};C=e.Templating=e.Templating||{};D=C.Runtime=C.Runtime||{};E=D.Server=D.Server||{};F=E.TemplateInstance=E.TemplateInstance||{};G=d.Arrays=d.Arrays||{};H=E.ProviderBuilder=E.ProviderBuilder||{};I=E.Handler=E.Handler||{};J=e.View=e.View||{};K=a.todo_Templates=a.todo_Templates||{};L=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};M=q.HashSet=q.HashSet||{};N=d.Seq=d.Seq||{};O=a.WindowOrWorkerGlobalScope;P=e.Docs=e.Docs||{};Q=q.Map=q.Map||{};R=e.Storage=e.Storage||{};S=d.Numeric=d.Numeric||{};T=e.Routing=e.Routing||{};U=e.ConcreteVar=e.ConcreteVar||{};V=e.Snap=e.Snap||{};W=a.System=a.System||{};X=W.Guid=W.Guid||{};Y=q.List=q.List||{};Z=e.AttrProxy=e.AttrProxy||{};_0=e.Attrs=e.Attrs||{};_1=a.Event;_2=a.UIEvent;_3=d.Strings=d.Strings||{};_4=q.DictionaryUtil=q.DictionaryUtil||{};_5=a.Object;_6=g.Prepare=g.Prepare||{};_7=d.Slice=d.Slice||{};_8=e.DomUtility=e.DomUtility||{};_9=d.Enumerator=d.Enumerator||{};_=q.KeyCollection=q.KeyCollection||{};$=e.DocElemNode=e.DocElemNode||{};ba=a.CharacterData;bb=e.An=e.An||{};bc=f.Settings=f.Settings||{};bd=e.Abbrev=e.Abbrev||{};be=bd.Mailbox=bd.Mailbox||{};bf=q.FSharpMap=q.FSharpMap||{};bg=R.ArrayStorage=R.ArrayStorage||{};bh=e.Route=e.Route||{};bi=bd.Fresh=bd.Fresh||{};bj=e.HtmlModule=e.HtmlModule||{};bk=bj.attr=bj.attr||{};bl=e.Array=e.Array||{};bm=E.TemplateInitializer=E.TemplateInitializer||{};bn=f.Attrs=f.Attrs||{};bo=bn.Dyn=bn.Dyn||{};bp=f.Docs=f.Docs||{};bq=bp.RunState=bp.RunState||{};br=bp.NodeSet=bp.NodeSet||{};bs=d.Concurrency=d.Concurrency||{};bt=e.Anims=e.Anims||{};bu=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bv=q.MapUtil=q.MapUtil||{};bw=e.AppendList=e.AppendList||{};bx=e.DynamicAttrNode=e.DynamicAttrNode||{};by=e.CheckedInput=e.CheckedInput||{};bz=_9.T=_9.T||{};bA=e.BindVar=e.BindVar||{};bB=e.Elt=e.Elt||{};bC=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bD=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bE=q.BalancedTree=q.BalancedTree||{};bF=bE.Tree=bE.Tree||{};bG=q.Pair=q.Pair||{};bH=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bI=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bJ=e.Updates=e.Updates||{};bK=q.HashSetUtil=q.HashSetUtil||{};bL=bs.Scheduler=bs.Scheduler||{};bM=e.Easing=e.Easing||{};bN=bs.AsyncBody=bs.AsyncBody||{};bO=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bP=bs.CT=bs.CT||{};bQ=bd.HashSet=bd.HashSet||{};bR=d.Queue=d.Queue||{};bS=e.String=e.String||{};bT=d.CancellationTokenSource=d.CancellationTokenSource||{};bU=bp.DomNodes=bp.DomNodes||{};bV=d.Char=d.Char||{};bW=q.ValueCollection=q.ValueCollection||{};bX=a.Error;bY=d.OperationCanceledException=d.OperationCanceledException||{};bZ=d.Lazy=d.Lazy||{};b0=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b1=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};b2=b1.LazyRecord=b1.LazyRecord||{};b3=a.IntelliFactory;b4=b3&&b3.Runtime;b5=a.console;b6=a.Math;b7=a.Date;c.Main=function(){var b8;b8=c.TodoApp();g.LoadLocalTemplates("");i.RunById("main",b8);};c.TodoApp=function(){l.$cctor();return l.TodoApp;};c.Pages=function(){l.$cctor();return l.Pages;};c.notDoneItemsCount=function(b8){return J.Map(function(b9){return N.sumBy(function(b_){return b_.IsDone?0:1;},b9);},b8.v);};c.RenderList=function(b8,b9){return i.Flatten(b8.MapLens(function(b_,b$){return c.RenderTodo(b8,b9,b_,b$);}));};c.ShowIfNotEmpty=function(b8,b9){return i.EmbedView(J.Map(function(b_){return N.isEmpty(b_)?i.get_Empty():b9;},b8.v));};c.op_EqualsEqualsGreater=function(b8,b9){return Z.Create(b8,b9);};c.ToggleAllDone=function(b8){var b9;b9=b8.TryFind(function(b_){return!b_.IsDone;})!=null;b8.UpdateAll(function(b_){return{$:1,$0:y.New(b_.Id,b_.Text,b9,b_.IsEditing)};});};c.RemoveCompleted=function(b8){b8.RemoveBy(function(b9){return b9.IsDone;});};c.onEnter=function(b8,b9){if(b8.keyCode===13||b8.which===13)b9();};c.mkTodo=function(b8){return y.New(c.fresh(),b8,false,false);};c.hasAnyDoneItems=function(b8){function b9(b_){return b_.IsDone;}return J.Map(function(b_){return N.exists(b9,b_);},b8.v);};c.RenderTodo=function(b8,b9,b_,b$){var ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co;function cp(ct){if(ct==="")b8.RemoveByKey(b_);else b$.Update(function(cu){return y.New(cu.Id,ct,cu.IsDone,false);});}function cq(ct,cu,cv){c.onEnter(ct,function(){cp(cv);});return c.onEscape(ct,function(){cp(cu);});}function cr(){b$.Update(function(ct){z.Set(ca,ct.Text);return y.New(ct.Id,ct.Text,ct.IsDone,true);});}function cs(ct,cu){return cu.$==1?!ct.IsDone:cu.$==2?ct.IsDone:true;}ca=z.Create$1("");cb=i.Input([Z.Create("class","edit"),A.HandlerView("keydown",b$.get_View(),b4.Curried3(function(ct,cu,cv){return cq(cu,cv.Text,ca.Get());})),A.HandlerView("blur",b$.get_View(),b4.Curried3(function(ct,cu,cv){return cp(cv.Text);})),A.OnAfterRender(function(ct){ct.focus();})],ca);cc=(cd=(ce=(cf=z.Lens(b$,function(ct){return ct.IsDone;},function(ct,cu){return y.New(ct.Id,ct.Text,cu,ct.IsEditing);}),(cg=(ch=(ci=(cj=J.Map(function(ct){return ct.Text;},b$.get_View()),(ck=(cl=J.Map(function(ct){return _3.concat(" ",v.ofSeq(N.delay(function(){return N.append(ct.IsEditing?["editing"]:[],N.delay(function(){return ct.IsDone?["completed"]:[];}));})));},b$.get_View()),(cm=new H.New$1(),(cm.h.push({$:2,$0:"itemstate",$1:cl}),cm))),(ck.h.push({$:2,$0:"title",$1:cj}),ck))),(ci.h.push(I.EventQ2(ci.k,"destroy",function(){return ci.i;},function(){b8.RemoveByKey(b_);})),ci)),(ch.h.push(I.EventQ2(ch.k,"edit",function(){return ch.i;},function(){cr();})),ch)),(cg.h.push({$:9,$0:"checked",$1:cf}),cg))),(ce.h.push({$:0,$0:"titleediting",$1:cb}),ce)),(cn=I.CompleteHoles(cd.k,cd.h,[["checked",2]]),(co=new F.New(cn[1],K.listitem(cn[0])),cd.i=co,co))).get_Doc();return i.EmbedView(J.Map2(function(ct,cu){return cs(ct,cu)?cc:i.get_Empty();},b$.get_View(),b9));};c.fresh=function(){var b8;b8=c.runningId();c.set_runningId(c.runningId()+1);return b8;};c.onEscape=function(b8,b9){if(b8.keyCode===27||b8.which===27)b9();};c.set_runningId=function(b8){l.$cctor();l.runningId=b8;};c.runningId=function(){l.$cctor();return l.runningId;};g.LoadLocalTemplates=function(b8){!g.LocalTemplatesLoaded()?(g.set_LocalTemplatesLoaded(true),g.LoadNestedTemplates(self.document.body,"")):void 0;g.LoadedTemplates().set_Item(b8,g.LoadedTemplateFile(""));};g.LocalTemplatesLoaded=function(){L.$cctor();return L.LocalTemplatesLoaded;};g.set_LocalTemplatesLoaded=function(b8){L.$cctor();L.LocalTemplatesLoaded=b8;};g.LoadNestedTemplates=function(b8,b9){var b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl;function b_(cm){var cn,co;if(!b$.ContainsKey(cm)){cn=(co=null,[ca.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);if(cn[0]){cl.Add(cm);ca.Remove(cm);g.PrepareTemplateStrict(b9,{$:1,$0:cm},cn[1],{$:1,$0:b_});}else b5.warn(cl.Contains(cm)?"Encountered loop when instantiating "+cm:"Local template does not exist: "+cm);}}b$=g.LoadedTemplateFile(b9);ca=new r.New$5();cb=b8.querySelectorAll("[ws-template]");for(cc=0,cd=cb.length-1;cc<=cd;cc++){ce=cb[cc];cf=ce.getAttribute("ws-template").toLowerCase();ce.removeAttribute("ws-template");ca.set_Item(cf,g.FakeRootSingle(ce));}cg=b8.querySelectorAll("[ws-children-template]");for(ch=0,ci=cg.length-1;ch<=ci;ch++){cj=cg[ch];ck=cj.getAttribute("ws-children-template").toLowerCase();cj.removeAttribute("ws-children-template");ca.set_Item(ck,g.FakeRoot(cj));}cl=new M.New$3();while(ca.count>0)b_(N.head(ca.get_Keys()));};g.LoadedTemplates=function(){L.$cctor();return L.LoadedTemplates;};g.LoadedTemplateFile=function(b8){var b9,b_,b$;b9=(b_=null,[g.LoadedTemplates().TryGetValue(b8,{get:function(){return b_;},set:function(ca){b_=ca;}}),b_]);return b9[0]?b9[1]:(b$=new r.New$5(),(g.LoadedTemplates().set_Item(b8,b$),b$));};g.FakeRootSingle=function(b8){var b9,b_,b$,ca;b8.removeAttribute("ws-template");b9=b8.getAttribute("ws-replace");if(b9===null);else{b8.removeAttribute("ws-replace");b_=b8.parentNode;s.Equals(b_,null)?void 0:(b$=self.document.createElement(b8.tagName),b$.setAttribute("ws-replace",b9),b_.replaceChild(b$,b8));}ca=self.document.createElement("div");ca.appendChild(b8);return ca;};g.FakeRoot=function(b8){var b9;b9=self.document.createElement("div");while(b8.hasChildNodes())b9.appendChild(b8.firstChild);return b9;};g.PrepareTemplateStrict=function(b8,b9,b_,b$){var ca;function cb(ch,ci){var cj,ck,cl,cm,cn,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ;function co(cK){}while(true)switch(ch){case 0:if(ci!==null){cj=ci.nextSibling;if(s.Equals(ci.nodeType,o.TEXT_NODE))_6.convertTextNode(ci);else if(s.Equals(ci.nodeType,o.ELEMENT_NODE))cd(ci);ci=cj;}else return null;break;case 1:cp=_7.string(ci.nodeName,{$:1,$0:3},null).toLowerCase();cq=(ck=cp.indexOf("."),ck===-1?[b8,cp]:[_7.string(cp,null,{$:1,$0:ck-1}),_7.string(cp,{$:1,$0:ck+1},null)]);cr=cq[1];cs=cq[0];if(cs!==""&&!g.LoadedTemplates().ContainsKey(cs))return _6.failNotLoaded(cr);else{if(cs===""&&b$!=null)b$.$0(cr);ct=g.LoadedTemplates().get_Item(cs);if(!ct.ContainsKey(cr))return _6.failNotLoaded(cr);else{cu=ct.get_Item(cr);cv=cu.cloneNode(true);cw=new M.New$3();cx=new r.New$5();cy=ci.attributes;for(cz=0,cA=cy.length-1;cz<=cA;cz++){cB=cy.item(cz).name.toLowerCase();cx.set_Item(cB,(cC=cy.item(cz).nodeValue,cC===""?cB:cC.toLowerCase()));if(!cw.Add(cB))b5.warn("Hole mapped twice",cB);}for(cD=0,cE=ci.childNodes.length-1;cD<=cE;cD++){cF=ci.childNodes[cD];if(s.Equals(cF.nodeType,o.ELEMENT_NODE))!cw.Add(cF.nodeName.toLowerCase())?b5.warn("Hole filled twice",cr):void 0;}cG=ci.childNodes.length===1&&s.Equals(ci.firstChild.nodeType,o.TEXT_NODE);if(cG){cm=_6.fillTextHole(cv,ci.firstChild.textContent,cr);((function(cK){return function(cL){if(cL!=null)cK(cL.$0);};}((cn=function(cK){return function(cL){return cK.Add(cL);};}(cw),function(cK){return co(cn(cK));})))(cm));}_6.removeHolesExcept(cv,cw);if(!cG){for(cH=0,cI=ci.childNodes.length-1;cH<=cI;cH++){cJ=ci.childNodes[cH];if(s.Equals(cJ.nodeType,o.ELEMENT_NODE))cJ.hasAttributes()?_6.fillInstanceAttrs(cv,cJ):cc(cv,cJ);}}_6.mapHoles(cv,cx);_6.fill(cv,ci.parentNode,ci);ci.parentNode.removeChild(ci);return;}}break;}}function cc(ch,ci){var cj,cl,cm;function ck(cn,co){var cp;if(cl==="title"&&ci.hasChildNodes()){cp=_8.ParseHTMLIntoFakeRoot(ci.textContent);ci.removeChild(ci.firstChild);while(cp.hasChildNodes())ci.appendChild(cp.firstChild);}else null;cd(ci);return _6.fill(ci,cn,co);}cl=ci.nodeName.toLowerCase();g.foreachNotPreserved(ch,"[ws-attr-holes]",function(cn){var co,cp,cq,cr,cs;co=_3.SplitChars(cn.getAttribute("ws-attr-holes"),[" "],1);for(cp=0,cq=co.length-1;cp<=cq;cp++){cr=G.get(co,cp);cn.setAttribute(cr,(cs=new a.RegExp("\\${"+cl+"}","ig"),cn.getAttribute(cr).replace(cs,ci.textContent)));}});cm=ch.querySelector("[ws-hole="+cl+"]");if(s.Equals(cm,null)){cj=ch.querySelector("[ws-replace="+cl+"]");return s.Equals(cj,null)?null:(ck(cj.parentNode,cj),void cj.parentNode.removeChild(cj));}else{while(cm.hasChildNodes())cm.removeChild(cm.lastChild);cm.removeAttribute("ws-hole");return ck(cm,null);}}function cd(ch){if(!ch.hasAttribute("ws-preserve"))if(_3.StartsWith(ch.nodeName.toLowerCase(),"ws-"))cf(ch);else{_6.convertAttrs(ch);ce(ch.firstChild);}}function ce(ch){return cb(0,ch);}function cf(ch){return cb(1,ch);}function cg(ch){var ci,cj,ck,cl;while(true){ci=ch.querySelector("[ws-template]");if(s.Equals(ci,null)){cj=ch.querySelector("[ws-children-template]");if(s.Equals(cj,null))return null;else{ck=cj.getAttribute("ws-children-template");cj.removeAttribute("ws-children-template");g.PrepareTemplateStrict(b8,{$:1,$0:ck},cj,null);ch=ch;}}else{cl=ci.getAttribute("ws-template");(g.PrepareSingleTemplate(b8,{$:1,$0:cl},ci))(null);ch=ch;}}}ca=(b9==null?"":b9.$0).toLowerCase();g.LoadedTemplateFile(b8).set_Item(ca,b_);if(b_.hasChildNodes()){cg(b_);ce(b_.firstChild);}};g.foreachNotPreserved=function(b8,b9,b_){_8.IterSelector(b8,b9,function(b$){if(b$.closest("[ws-preserve]")==null)b_(b$);});};g.PrepareSingleTemplate=function(b8,b9,b_){var b$;b$=g.FakeRootSingle(b_);return function(ca){g.PrepareTemplateStrict(b8,b9,b$,ca);};};g.GetOrLoadTemplate=function(b8,b9,b_,b$){g.LoadLocalTemplates("");g.PrepareTemplate(b8,b9,b_);return g.NamedTemplate(b8,b9,b$);};g.PrepareTemplate=function(b8,b9,b_){if(!g.LoadedTemplateFile(b8).ContainsKey(b9==null?"":b9.$0))g.PrepareTemplateStrict(b8,b9,b_(),null);};g.TextHoleRE=function(){L.$cctor();return L.TextHoleRE;};g.NamedTemplate=function(b8,b9,b_){var b$,ca;b$=(ca=null,[g.LoadedTemplateFile(b8).TryGetValue(b9==null?"":b9.$0,{get:function(){return ca;},set:function(cb){ca=cb;}}),ca]);return b$[0]?g.ChildrenTemplate(b$[1].cloneNode(true),b_):(b5.warn("Local template doesn't exist",b9),i.get_Empty());};g.ChildrenTemplate=function(b8,b9){var b_,b$,ca,cb,cc;b_=g.InlineTemplate(b8,N.append(b9,g.GlobalHoles().get_Values()));b$=b_[1];ca=b_[0];cb=ca.Els;return!s.Equals(cb,null)&&cb.length===1&&(G.get(cb,0)instanceof o&&(s.Equals(G.get(cb,0).nodeType,o.ELEMENT_NODE)&&(cc=G.get(cb,0),true)))?bB.TreeNode(ca,b$):i.Mk({$:6,$0:ca},b$);};g.InlineTemplate=function(b8,b9){var b_,b$,ca,cb,ce,cf,cg,ch,ci,cj,ck;function cc(cl,cm){var cn,co,cp;cn=_0.Insert(cl,cm);cf.push(_0.Updates(cn));cg.push([cl,cn]);co=b4.GetOptional(cn.OnAfterRender);return co==null?null:(cp=co.$0,void ch.push(function(){cp(cl);}));}function cd(cl){var cm,cn;cm=(cn=null,[ci.TryGetValue(cl,{get:function(){return cn;},set:function(co){cn=co;}}),cn]);return cm[0]?cm[1].$==0?{$:1,$0:cm[1].$1}:cm[1].$==1?{$:1,$0:i.TextNode(cm[1].$1)}:cm[1].$==2?{$:1,$0:i.TextView(cm[1].$1)}:cm[1].$==8?{$:1,$0:i.TextView(cm[1].$1.get_View())}:cm[1].$==9?{$:1,$0:i.TextView(J.Map(a.String,cm[1].$1.get_View()))}:cm[1].$==10?{$:1,$0:i.TextView(J.Map(function(co){return co.get_Input();},cm[1].$1.get_View()))}:cm[1].$==11?{$:1,$0:i.TextView(J.Map(a.String,cm[1].$1.get_View()))}:cm[1].$==12?{$:1,$0:i.TextView(J.Map(function(co){return co.get_Input();},cm[1].$1.get_View()))}:cm[1].$==13?{$:1,$0:i.TextView(J.Map(a.String,cm[1].$1.get_View()))}:(b5.warn("Content hole filled with attribute data",cl),null):null;}ce=[];cf=[];cg=[];ch=[];ci=new r.New$5();cj=_9.Get(b9);try{while(cj.MoveNext()){ck=cj.Current();ci.set_Item(ck.$0,ck);}}finally{if(typeof cj=="object"&&"Dispose"in cj)cj.Dispose();}b_=_8.ChildrenArray(b8);g.foreachNotPreserved(b8,"[ws-hole]",function(cl){var cm,cn,co;co=cl.getAttribute("ws-hole");cl.removeAttribute("ws-hole");while(cl.hasChildNodes())cl.removeChild(cl.lastChild);cm=cd(co);if(cm!=null&&cm.$==1){cn=cm.$0;P.LinkElement(cl,cn.docNode);ce.push($.New(_0.Empty(cl),cn.docNode,null,cl,bi.Int(),null));cf.push(cn.updates);}});g.foreachNotPreserved(b8,"[ws-replace]",function(cl){var cm,cn,co,cp,cq,cr;cm=cd(cl.getAttribute("ws-replace"));if(cm!=null&&cm.$==1){cn=cm.$0;co=cl.parentNode;cp=self.document.createTextNode("");co.replaceChild(cp,cl);cq=P.InsertBeforeDelim(cp,cn.docNode);cr=G.tryFindIndex(function(cs){return cl===cs;},b_);cr==null?void 0:G.set(b_,cr.$0,cn.docNode);ce.push($.New(_0.Empty(co),cn.docNode,{$:1,$0:[cq,cp]},co,bi.Int(),null));cf.push(cn.updates);}});g.foreachNotPreserved(b8,"[ws-attr]",function(cl){var cm,cn,co;cm=cl.getAttribute("ws-attr");cl.removeAttribute("ws-attr");cn=(co=null,[ci.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);if(cn[0])cn[1].$==3?cc(cl,cn[1].$1):b5.warn("Attribute hole filled with non-attribute data",cm);});g.foreachNotPreserved(b8,"[ws-on]",function(cl){cc(cl,Z.Concat(G.choose(function(cm){var cn,co,cp;cn=_3.SplitChars(cm,[":"],1);co=(cp=null,[ci.TryGetValue(G.get(cn,1),{get:function(){return cp;},set:function(cq){cp=cq;}}),cp]);return co[0]?co[1].$==4?{$:1,$0:A.Handler(G.get(cn,0),co[1].$1)}:co[1].$==5?{$:1,$0:Z.Handler(G.get(cn,0),co[1].$1)}:(b5.warn("Event hole on"+G.get(cn,0)+" filled with non-event data",G.get(cn,1)),null):null;},_3.SplitChars(cl.getAttribute("ws-on"),[" "],1))));cl.removeAttribute("ws-on");});g.foreachNotPreserved(b8,"[ws-onafterrender]",function(cl){var cm,cn,co;cm=cl.getAttribute("ws-onafterrender");cn=(co=null,[ci.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);if(cn[0])cn[1].$==6?(cl.removeAttribute("ws-onafterrender"),cc(cl,A.OnAfterRender(cn[1].$1))):cn[1].$==7?(cl.removeAttribute("ws-onafterrender"),cc(cl,A.OnAfterRender(cn[1].$1))):b5.warn("onafterrender hole filled with non-onafterrender data",cm);});g.foreachNotPreserved(b8,"[ws-var]",function(cl){var cm,cn,co;cm=cl.getAttribute("ws-var");cl.removeAttribute("ws-var");cn=(co=null,[ci.TryGetValue(cm,{get:function(){return co;},set:function(cp){co=cp;}}),co]);if(cn[0])cn[1].$==8?cc(cl,A.Value(cn[1].$1)):cn[1].$==9?cc(cl,A.Checked(cn[1].$1)):cn[1].$==10?cc(cl,A.IntValue(cn[1].$1)):cn[1].$==11?cc(cl,A.IntValueUnchecked(cn[1].$1)):cn[1].$==12?cc(cl,A.FloatValue(cn[1].$1)):cn[1].$==13?cc(cl,A.FloatValueUnchecked(cn[1].$1)):b5.warn("Var hole filled with non-Var data",cm);});g.foreachNotPreserved(b8,"[ws-attr-holes]",function(cl){var cm,cn,co,cp;cm=new a.RegExp(g.TextHoleRE(),"g");cn=_3.SplitChars(cl.getAttribute("ws-attr-holes"),[" "],1);cl.removeAttribute("ws-attr-holes");for(co=0,cp=cn.length-1;co<=cp;co++)(function(){var cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC;cz=G.get(cn,co);cA=cl.getAttribute(cz);cq=null;cr=0;cB=[];while(cq=cm.exec(cA),cq!==null){cC=_7.string(cA,{$:1,$0:cr},{$:1,$0:cm.lastIndex-G.get(cq,0).length-1});cr=cm.lastIndex;cB.push([cC,G.get(cq,1)]);}ct=_7.string(cA,{$:1,$0:cr},null);cm.lastIndex=0;cu=G.foldBack(function(cD,cE){return(function(cF){var cG,cH;cG=cF[0];cH=cF[1];return function(cI){var cJ,cK,cL,cM,cN;cJ=cI[0];cK=cI[1];cL=(cM=(cN=null,[ci.TryGetValue(cH,{get:function(){return cN;},set:function(cO){cN=cO;}}),cN]),cM[0]?cM[1].$==1?{$:0,$0:cM[1].$1}:cM[1].$==2?{$:1,$0:cM[1].$1}:cM[1].$==8?{$:1,$0:cM[1].$1.get_View()}:cM[1].$==9?{$:1,$0:J.Map(a.String,cM[1].$1.get_View())}:cM[1].$==10?{$:1,$0:J.Map(function(cO){return cO.get_Input();},cM[1].$1.get_View())}:cM[1].$==11?{$:1,$0:J.Map(a.String,cM[1].$1.get_View())}:cM[1].$==12?{$:1,$0:J.Map(function(cO){return cO.get_Input();},cM[1].$1.get_View())}:cM[1].$==13?{$:1,$0:J.Map(a.String,cM[1].$1.get_View())}:(b5.warn("Attribute value hole filled with non-text data",cH),{$:0,$0:""}):{$:0,$0:""});return cL.$==1?[cG,new w({$:1,$0:cJ===""?cL.$0:J.Map(function(cO){return cO+cJ;},cL.$0),$1:cK})]:[cG+cL.$0+cJ,cK];};}(cD))(cE);},cB,[ct,w.Empty]);return cc(cl,cu[1].$==1?cu[1].$1.$==1?cu[1].$1.$1.$==1?cu[1].$1.$1.$1.$==0?(cv=cu[0],A.Dynamic(cz,J.Map3(function(cD,cE,cF){return cv+cD+cE+cF;},cu[1].$0,cu[1].$1.$0,cu[1].$1.$1.$0))):(cw=cu[0],A.Dynamic(cz,J.Map(function(cD){return cw+_3.concat("",cD);},J.Sequence(cu[1])))):(cx=cu[0],A.Dynamic(cz,J.Map2(function(cD,cE){return cx+cD+cE;},cu[1].$0,cu[1].$1.$0))):cu[0]===""?A.Dynamic(cz,cu[1].$0):(cy=cu[0],A.Dynamic(cz,J.Map(function(cD){return cy+cD;},cu[1].$0))):Z.Create(cz,cu[0]));}());});return[b4.DeleteEmptyFields({Els:b_,Dirty:true,Holes:ce,Attrs:cg,Render:(b$=ch.length==0?null:{$:1,$0:function(cl){G.iter(function(cm){cm(cl);},ch);}},b$?b$.$0:void 0),El:(ca=!s.Equals(b_,null)&&b_.length===1&&(G.get(b_,0)instanceof o&&(G.get(b_,0)instanceof a.Element&&(cb=G.get(b_,0),true)))?{$:1,$0:cb}:null,ca?ca.$0:void 0)},["Render","El"]),bl.TreeReduce(J.Const(),J.Map2Unit,cf)];};g.GlobalHoles=function(){L.$cctor();return L.GlobalHoles;};h=d.Obj=b4.Class({Equals:function(b8){return this===b8;},GetHashCode:function(){return -1;}},null,h);h.New=b4.Ctor(function(){},h);i=e.Doc=b4.Class({},h,i);i.RunById=function(b8,b9){var b_;b_=self.document.getElementById(b8);if(s.Equals(b_,null))m.FailWith("invalid id: "+b8);else i.Run(b_,b9);};i.Run=function(b8,b9){P.LinkElement(b8,b9.docNode);i.RunInPlace(false,b8,b9);};i.get_Empty=function(){return i.Mk(null,J.Const());};i.RunInPlace=function(b8,b9,b_){var b$;b$=P.CreateRunState(b9,b_.docNode);J.Sink(bb.get_UseAnimations()||bc.BatchUpdatesEnabled()?be.StartProcessor(P.PerformAnimatedUpdate(b8,b$,b_.docNode)):function(){P.PerformSyncUpdate(b8,b$,b_.docNode);},b_.updates);};i.CheckBox=function(b8,b9){return i.InputInternal("input",function(){return N.append(b8,[Z.Create("type","checkbox"),A.Checked(b9)]);});};i.EmbedView=function(b8){var b9;b9=P.CreateEmbedNode();return i.Mk({$:2,$0:b9},J.Map(a.ignore,J.Bind(function(b_){P.UpdateEmbedNode(b9,b_.docNode);return b_.updates;},b8)));};i.Concat=function(b8){var b9;b9=bl.ofSeqNonCopying(b8);return bl.TreeReduce(i.get_Empty(),i.Append,b9);};i.Link=function(b8,b9,b_){var b$,ca;b$=(ca=Z.Concat(b9),Z.Append(Z.Create("href","#"),ca));return bB.New(i.Clickable("a",b_),b$,i.TextNode(b8));};i.Button=function(b8,b9,b_){var b$;b$=Z.Concat(b9);return bB.New(i.Clickable("button",b_),b$,i.TextNode(b8));};i.Mk=function(b8,b9){return new i.New(b8,b9);};i.Flatten=function(b8){return i.EmbedView(J.Map(i.Concat,b8));};i.InputInternal=function(b8,b9){var b_;b_=self.document.createElement(b8);return bB.New(b_,Z.Concat(b9(b_)),i.get_Empty());};i.Append=function(b8,b9){return i.Mk({$:0,$0:b8.docNode,$1:b9.docNode},J.Map2Unit(b8.updates,b9.updates));};i.Element=function(b8,b9,b_){var b$,ca;b$=Z.Concat(b9);ca=i.Concat(b_);return bB.New(self.document.createElement(b8),b$,ca);};i.TextNode=function(b8){return i.Mk({$:5,$0:self.document.createTextNode(b8)},J.Const());};i.Clickable=function(b8,b9){var b_;b_=self.document.createElement(b8);b_.addEventListener("click",function(b$){b$.preventDefault();return b9();},false);return b_;};i.Input=function(b8,b9){return i.InputInternal("input",function(){return N.append(b8,[A.Value(b9)]);});};i.TextView=function(b8){var b9;b9=P.CreateTextNode();return i.Mk({$:4,$0:b9},J.Map(function(b_){P.UpdateTextNode(b9,b_);},b8));};i.New=b4.Ctor(function(b8,b9){h.New.call(this);this.docNode=b8;this.updates=b9;},i);k.NewFromSeq=function(b8){var b9,b_,b$;b9={};b_=_9.Get(b8);try{while(b_.MoveNext()){b$=b_.Current();b9[b$[0]]=b$[1];}}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}return b9;};l.$cctor=function(){var b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx;l.$cctor=a.ignore;function cy(cA){c.onEnter(cA,function(){var cB;cB=_3.Trim(b_.Get());if(cB!==""){b8.Append(c.mkTodo(cB));z.Set(b_,"");}});}function cz(cA){return A.DynamicClass("selected",b9.get_View(),function(cB){return s.Equals(cA,cB);});}l.Pages=t.Create(function(cA){return cA.$==1?v.ofArray(["active"]):cA.$==2?v.ofArray(["completed"]):w.Empty;},function(cA){var cB;switch(cA.$==1?cA.$0==="active"?cA.$1.$==0?0:2:cA.$0==="completed"?cA.$1.$==0?1:2:2:2){case 0:return u.Active;case 1:return u.Completed;case 2:return u.All;}});l.runningId=0;l.TodoApp=(b8=x.Create(function(cA){return cA.Id;},w.Empty),(b9=t.Install(c.Pages()),(b_=z.Create$1(""),(b$=z.Create$1(false),(ca=c.notDoneItemsCount(b8),(cb=J.Map(function(cA){return cA===0;},ca),(cc=(cd=c.ShowIfNotEmpty(b8,(ce=(cf=i.EmbedView(J.Map(function(cA){return cA?i.Button("Clear Completed",[c.op_EqualsEqualsGreater("class","clear-completed")],function(){c.RemoveCompleted(b8);}):i.get_Empty();},c.hasAnyDoneItems(b8))),(cg=(ch=v.ofArray([i.Element("li",[],[i.Link("All",[cz(u.All)],function(){z.Set(b9,u.All);})]),i.Element("li",[],[i.Link("Active",[cz(u.Active)],function(){z.Set(b9,u.Active);})]),i.Element("li",[],[i.Link("Completed",[cz(u.Completed)],function(){z.Set(b9,u.Completed);})])]),(ci=(cj=J.Map(function(cA){return cA===1?"item":"items";},ca),(ck=(cl=J.Map(a.String,ca),(cm=new H.New$1(),(cm.h.push({$:2,$0:"remaining",$1:cl}),cm))),(ck.h.push({$:2,$0:"remaininglabel",$1:cj}),ck))),(ci.h.push({$:0,$0:"filters",$1:i.Concat(ch)}),ci))),(cg.h.push({$:0,$0:"clearcompleted",$1:cf}),cg))),(cn=I.CompleteHoles(ce.k,ce.h,[]),(co=new F.New(cn[1],K.footertemplate(cn[0])),ce.i=co,co))).get_Doc()),(cp=(cq=c.ShowIfNotEmpty(b8,i.EmbedView(J.Map(function(){return i.CheckBox([c.op_EqualsEqualsGreater("class","toggle-all"),c.op_EqualsEqualsGreater("type","checkbox"),A.Handler("click",function(){return function(){return c.ToggleAllDone(b8);};})],b$);},cb))),(cr=(cs=(ct=c.RenderList(b8,b9.get_View()),(cu=(cv=new H.New$1(),(cv.h.push({$:8,$0:"newtask",$1:b_}),cv)),(cu.h.push({$:0,$0:"todolist",$1:ct}),cu))),(cs.h.push(I.EventQ2(cs.k,"add",function(){return cs.i;},function(cA){cy(cA.Event);})),cs)),(cr.h.push({$:0,$0:"toggleall",$1:cq}),cr))),(cp.h.push({$:0,$0:"footer",$1:cd}),cp))),(cw=I.CompleteHoles(cc.k,cc.h,[["newtask",0]]),(cx=new F.New(cw[1],K.t(cw[0])),cc.i=cx,cx))).get_Doc()))))));};m.FailWith=function(b8){throw new bX(b8);};m.KeyValue=function(b8){return[b8.K,b8.V];};p.GetFieldValues=function(b8){var b9,b_;b9=[];for(var b$ in b8)b9.push(b8[b$]);return b9;};r=q.Dictionary=b4.Class({set_Item:function(b8,b9){this.set(b8,b9);},ContainsKey:function(b8){var b9,b_;b9=this;b_=this.data[this.hash(b8)];return b_==null?false:G.exists(function(b$){return b9.equals.apply(null,[(m.KeyValue(b$))[0],b8]);},b_);},TryGetValue:function(b8,b9){var b_,b$,ca;b_=this;b$=this.data[this.hash(b8)];return b$==null?false:(ca=G.tryPick(function(cb){var cc;cc=m.KeyValue(cb);return b_.equals.apply(null,[cc[0],b8])?{$:1,$0:cc[1]}:null;},b$),ca!=null&&ca.$==1&&(b9.set(ca.$0),true));},Remove:function(b8){return this.remove(b8);},get_Keys:function(){return new _.New(this);},set:function(b8,b9){var b_,b$,ca,cb;b_=this;b$=this.hash(b8);ca=this.data[b$];if(ca==null){this.count=this.count+1;this.data[b$]=new a.Array({K:b8,V:b9});}else{cb=G.tryFindIndex(function(cc){return b_.equals.apply(null,[(m.KeyValue(cc))[0],b8]);},ca);cb==null?(this.count=this.count+1,ca.push({K:b8,V:b9})):ca[cb.$0]={K:b8,V:b9};}},remove:function(b8){var b9,b_,b$,ca;b9=this;b_=this.hash(b8);b$=this.data[b_];return b$==null?false:(ca=G.filter(function(cb){return!b9.equals.apply(null,[(m.KeyValue(cb))[0],b8]);},b$),G.length(ca)<b$.length&&(this.count=this.count-1,this.data[b_]=ca,true));},get_Item:function(b8){return this.get(b8);},get:function(b8){var b9,b_;b9=this;b_=this.data[this.hash(b8)];return b_==null?_4.notPresent():G.pick(function(b$){var ca;ca=m.KeyValue(b$);return b9.equals.apply(null,[ca[0],b8])?{$:1,$0:ca[1]}:null;},b_);},Clear:function(){this.data=[];this.count=0;},get_Values:function(){return new bW.New(this);},GetEnumerator:function(){return _9.Get0(this);},GetEnumerator0:function(){return _9.Get0(G.concat(p.GetFieldValues(this.data)));}},h,r);r.New$5=b4.Ctor(function(){r.New$6.call(this,[],s.Equals,s.Hash);},r);r.New$6=b4.Ctor(function(b8,b9,b_){var b$,ca;h.New.call(this);this.equals=b9;this.hash=b_;this.count=0;this.data=[];b$=_9.Get(b8);try{while(b$.MoveNext()){ca=b$.Current();this.set(ca.K,ca.V);}}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}},r);s.Equals=function(b8,b9){var b_,b$,ca,cb;if(b8===b9)return true;else{b_=typeof b8;if(b_=="object"){if(b8===null||b8===void 0||b9===null||b9===void 0)return false;else if("Equals"in b8)return b8.Equals(b9);else if(b8 instanceof a.Array&&b9 instanceof a.Array)return s.arrayEquals(b8,b9);else if(b8 instanceof a.Date&&b9 instanceof a.Date)return s.dateEquals(b8,b9);else{b$=[true];for(var cc in b8)if(function(cd){b$[0]=!b8.hasOwnProperty(cd)||b9.hasOwnProperty(cd)&&s.Equals(b8[cd],b9[cd]);return!b$[0];}(cc))break;if(b$[0]){for(var cd in b9)if(function(ce){b$[0]=!b9.hasOwnProperty(ce)||b8.hasOwnProperty(ce);return!b$[0];}(cd))break;}return b$[0];}}else return b_=="function"&&("$Func"in b8?b8.$Func===b9.$Func&&b8.$Target===b9.$Target:"$Invokes"in b8&&"$Invokes"in b9&&s.arrayEquals(b8.$Invokes,b9.$Invokes));}};s.arrayEquals=function(b8,b9){var b_,b$;if(G.length(b8)===G.length(b9)){b_=true;b$=0;while(b_&&b$<G.length(b8)){!s.Equals(G.get(b8,b$),G.get(b9,b$))?b_=false:void 0;b$=b$+1;}return b_;}else return false;};s.dateEquals=function(b8,b9){return b8.getTime()===b9.getTime();};s.Hash=function(b8){var b9;b9=typeof b8;return b9=="function"?0:b9=="boolean"?b8?1:0:b9=="number"?b8:b9=="string"?s.hashString(b8):b9=="object"?b8==null?0:b8 instanceof a.Array?s.hashArray(b8):s.hashObject(b8):0;};s.hashString=function(b8){var b9,b_,b$;if(b8===null)return 0;else{b9=5381;for(b_=0,b$=b8.length-1;b_<=b$;b_++)b9=s.hashMix(b9,b8[b_].charCodeAt());return b9;}};s.hashArray=function(b8){var b9,b_,b$;b9=-34948909;for(b_=0,b$=G.length(b8)-1;b_<=b$;b_++)b9=s.hashMix(b9,s.Hash(G.get(b8,b_)));return b9;};s.hashObject=function(b8){var b9,b_;if("GetHashCode"in b8)return b8.GetHashCode();else{b9=[0];for(var b$ in b8)if(function(ca){b9[0]=s.hashMix(s.hashMix(b9[0],s.hashString(ca)),s.Hash(b8[ca]));return false;}(b$))break;return b9[0];}};s.hashMix=function(b8,b9){return(b8<<5)+b8+b9;};s.Compare=function(b8,b9){var b_,b$,ca,cb,cc,cd;if(b8===b9)return 0;else{b$=typeof b8;switch(b$=="function"?1:b$=="boolean"?2:b$=="number"?2:b$=="string"?2:b$=="object"?3:0){case 0:return typeof b9=="undefined"?0:-1;case 1:return m.FailWith("Cannot compare function values.");case 2:return b8<b9?-1:1;case 3:if(b8===null)ca=-1;else if(b9===null)ca=1;else if("CompareTo"in b8)ca=b8.CompareTo(b9);else if("CompareTo0"in b8)ca=b8.CompareTo0(b9);else if(b8 instanceof a.Array&&b9 instanceof a.Array)ca=s.compareArrays(b8,b9);else if(b8 instanceof a.Date&&b9 instanceof a.Date)ca=s.compareDates(b8,b9);else{cb=[0];for(var ce in b8)if(function(cf){return!b8.hasOwnProperty(cf)?false:!b9.hasOwnProperty(cf)?(cb[0]=1,true):(cb[0]=s.Compare(b8[cf],b9[cf]),cb[0]!==0);}(ce))break;if(cb[0]===0){for(var cf in b9)if(function(cg){return!b9.hasOwnProperty(cg)?false:!b8.hasOwnProperty(cg)&&(cb[0]=-1,true);}(cf))break;}ca=cb[0];}return ca;}}};s.compareArrays=function(b8,b9){var b_,b$;if(G.length(b8)<G.length(b9))return -1;else if(G.length(b8)>G.length(b9))return 1;else{b_=0;b$=0;while(b_===0&&b$<G.length(b8)){b_=s.Compare(G.get(b8,b$),G.get(b9,b$));b$=b$+1;}return b_;}};s.compareDates=function(b8,b9){return s.Compare(b8.getTime(),b9.getTime());};t.Create=function(b8,b9){function b_(b$){return b$[0];}return{Des:function(b$){return b9(b_(b$));},Ser:function(b$){return[b8(b$),new bf.New([])];}};};t.Install=function(b8){return T.InstallMap(b8);};u.Active={$:1};u.Completed={$:2};u.All={$:0};v.ofArray=function(b8){var b9,b_,b$;b9=w.Empty;for(b_=G.length(b8)-1,b$=0;b_>=b$;b_--)b9=new w({$:1,$0:G.get(b8,b_),$1:b9});return b9;};v.ofSeq=function(b8){var b9,b_,b$,ca,cb,cc;if(b8 instanceof w)return b8;else if(b8 instanceof a.Array)return v.ofArray(b8);else{b9=_9.Get(b8);try{b$=b9.MoveNext();if(!b$)b_=w.Empty;else{cb=new w({$:1});ca=cb;while(b$){ca.$0=b9.Current();if(b9.MoveNext())ca=(cc=new w({$:1}),ca.$1=cc,cc);else b$=false;}ca.$1=w.Empty;b_=cb;}return b_;}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}}};v.head=function(b8){return b8.$==1?b8.$0:v.listEmpty();};v.tail=function(b8){return b8.$==1?b8.$1:v.listEmpty();};v.listEmpty=function(){return m.FailWith("The input list was empty.");};w=v.T=b4.Class({GetEnumerator:function(){return new bz.New(this,null,function(b8){var b9;b9=b8.s;return b9.$==0?false:(b8.c=b9.$0,b8.s=b9.$1,true);},void 0);},GetEnumerator0:function(){return _9.Get(this);}},null,w);w.Empty=new w({$:0});x.Create=function(b8,b9){return x.CreateWithStorage(b8,R.InMemory(G.ofSeq(b9)));};x.CreateWithStorage=function(b8,b9){return new x.New(b8,b9);};y.New=function(b8,b9,b_,b$){return{Id:b8,Text:b9,IsDone:b_,IsEditing:b$};};z=e.Var$1=b4.Class({},h,z);z.Create$1=function(b8){return new U.New(false,V.New({$:2,$0:b8,$1:[]}),b8);};z.Set=function(b8,b9){b8.Set(b9);};z.Lens=function(b8,b9,b_){var b$,ca,cb;b$=bi.Id();ca=J.Map(b9,b8.get_View());cb=new B({Get:function(){return b9(b8.Get());},Set:function(cc){return b8.Update(function(cd){return b_(cd,cc);});},SetFinal:function(cc){return this.Set(cc);},Update:function(cc){return b8.Update(function(cd){return b_(cd,cc(b9(cd)));});},UpdateMaybe:function(cc){return b8.UpdateMaybe(function(cd){var ce;ce=cc(b9(cd));return ce==null?null:{$:1,$0:b_(cd,ce.$0)};});},get_View:function(){return ca;},get_Id:function(){return b$;}});B.New.call(cb);return cb;};A.DynamicClass=function(b8,b9,b_){return A.DynamicClassPred(b8,J.Map(b_,b9));};A.Handler=function(b8,b9){return _0.Static(function(b_){b_.addEventListener(b8,function(b$){return(b9(b_))(b$);},false);});};A.DynamicClassPred=function(b8,b9){return _0.Dynamic(b9,function(b_){return function(b$){return b$?_8.AddClass(b_,b8):_8.RemoveClass(b_,b8);};});};A.Checked=function(b8){var b9;b9=(((bA.BoolCheckedApply())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.HandlerView=function(b8,b9,b_){return _0.Static(function(b$){var ca;ca=b_(b$);b$.addEventListener(b8,function(cb){return J.Get(ca(cb),b9);},false);});};A.OnAfterRender=function(b8){return new Z({$:4,$0:b8});};A.DynamicCustom=function(b8,b9){return _0.Dynamic(b9,b8);};A.Value=function(b8){var b9;b9=(((bA.StringApply())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.IntValue=function(b8){var b9;b9=(((bA.IntApplyChecked())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.IntValueUnchecked=function(b8){var b9;b9=(((bA.IntApplyUnchecked())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.FloatValue=function(b8){var b9;b9=(((bA.FloatApplyChecked())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.FloatValueUnchecked=function(b8){var b9;b9=(((bA.FloatApplyUnchecked())(b8))(_0.Static))(function(b_){return A.DynamicCustom(b_,b8.get_View());});return Z.Append(b9[0],b9[1]);};A.Dynamic=function(b8,b9){return _0.Dynamic(b9,function(b_){return function(b$){return b_.setAttribute(b8,b$);};});};B=e.Var=b4.Class({},h,B);B.New=b4.Ctor(function(){h.New.call(this);},B);F=E.TemplateInstance=b4.Class({get_Doc:function(){return this.doc;}},h,F);F.New=b4.Ctor(function(b8,b9){h.New.call(this);this.doc=b9;this.allVars=b8.$==0?b8.$0:m.FailWith("Should not happen");},F);G.get=function(b8,b9){G.checkBounds(b8,b9);return b8[b9];};G.length=function(b8){return b8.dims===2?b8.length*b8.length:b8.length;};G.checkBounds=function(b8,b9){if(b9<0||b9>=b8.length)m.FailWith("Index was outside the bounds of the array.");};G.set=function(b8,b9,b_){G.checkBounds(b8,b9);b8[b9]=b_;};H=E.ProviderBuilder=b4.Class({},h,H);H.New$1=b4.Ctor(function(){var b8;h.New.call(this);this.i=null;this.k=(b8=X.NewGuid(),a.String(b8));this.h=[];b4.SetOptional(this,"s",null);},H);I.EventQ2=function(b8,b9,b_,b$){return{$:5,$0:b9,$1:function(ca){return function(cb){return b$({Vars:b_(),Target:ca,Event:cb});};}};};I.CompleteHoles=function(b8,b9,b_){var ca,cb,cc,cd,ce;function b$(cf,cg){var ch;return cb.Contains(cf)?null:(ch=cg===0?bm.GetOrAddHoleFor(b8,cf,function(){return{$:8,$0:cf,$1:z.Create$1("")};}):cg===1?bm.GetOrAddHoleFor(b8,cf,function(){return{$:13,$0:cf,$1:z.Create$1(0)};}):cg===2?bm.GetOrAddHoleFor(b8,cf,function(){return{$:9,$0:cf,$1:z.Create$1(false)};}):m.FailWith("Invalid value type"),(ca.set_Item(cf,ch),{$:1,$0:ch}));}ca=new r.New$5();cb=new M.New$3();cc=_9.Get(b9);try{while(cc.MoveNext()){cd=cc.Current();ce=cd.$0;cb.Add(ce);ca.set_Item(ce,cd);}}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}return[N.append(b9,G.choose(function(cf){return b$(cf[0],cf[1]);},b_)),{$:0,$0:ca}];};J.Map=function(b8,b9){return J.CreateLazy(function(){return V.Map(b8,b9());});};J.CreateLazy=function(b8){var b9;b9={c:null,o:b8};return function(){var b_,b$;b_=b9.c;return b_===null?(b_=b9.o(),b9.c=b_,(b$=b_.s,b$!=null&&b$.$==0)?b9.o=null:V.WhenObsoleteRun(b_,function(){b9.c=null;}),b_):b_;};};J.Const=function(b8){var b9;b9=V.New({$:0,$0:b8});return function(){return b9;};};J.Sink=function(b8,b9){function b_(){V.WhenRun(b9(),b8,function(){bs.scheduler().Fork(b_);});}bs.scheduler().Fork(b_);};J.Map2=function(b8,b9,b_){return J.CreateLazy(function(){return V.Map2(b8,b9(),b_());});};J.Bind=function(b8,b9){return J.Join(J.Map(b8,b9));};J.Join=function(b8){return J.CreateLazy(function(){return V.Join(b8());});};J.Map2Unit=function(b8,b9){return J.CreateLazy(function(){return V.Map2Unit(b8(),b9());});};J.MapSeqCachedViewBy=function(b8,b9,b_){var b$;b$=[new r.New$5()];return J.Map(function(ca){var cb,cc,cd;cb=b$[0];cc=new r.New$5();cd=bl.mapInPlace(function(ce){var cf,cg,ch;cf=b8(ce);cg=cb.ContainsKey(cf)?(ch=cb.get_Item(cf),(z.Set(ch.r,ce),ch)):J.ConvertSeqNode(function(ci){return b9(cf,ci);},ce);cc.set_Item(cf,cg);return cg.e;},G.ofSeq(ca));b$[0]=cc;return cd;},b_);};J.Get=function(b8,b9){var b_;function b$(){V.WhenRun(b9(),function(ca){if(!b_[0]){b_[0]=true;b8(ca);}},function(){if(!b_[0])b$();});}b_=[false];b$();};J.ConvertSeqNode=function(b8,b9){var b_,b$;b_=z.Create$1(b9);b$=b_.get_View();return{e:b8(b$),r:b_,w:b$};};J.Map3=function(b8,b9,b_,b$){return J.CreateLazy(function(){return V.Map3(b8,b9(),b_(),b$());});};J.Sequence=function(b8){return J.CreateLazy(function(){return V.Sequence(N.map(function(b9){return b9();},b8));});};K.footertemplate=function(b8){return b8?g.GetOrLoadTemplate("todoapp",{$:1,$0:"footertemplate"},function(){return _8.ParseHTMLIntoFakeRoot("<footer class=\"footer\">\r\n            <span class=\"todo-count\">\r\n                <strong>${Remaining}</strong>\r\n                ${RemainingLabel} left\r\n            </span>\r\n            <ul class=\"filters\" ws-hole=\"Filters\"></ul>\r\n            <span ws-replace=\"ClearCompleted\"></span>\r\n        </footer>");},b8):g.PrepareTemplate("todoapp",{$:1,$0:"footertemplate"},function(){return _8.ParseHTMLIntoFakeRoot("<footer class=\"footer\">\r\n            <span class=\"todo-count\">\r\n                <strong>${Remaining}</strong>\r\n                ${RemainingLabel} left\r\n            </span>\r\n            <ul class=\"filters\" ws-hole=\"Filters\"></ul>\r\n            <span ws-replace=\"ClearCompleted\"></span>\r\n        </footer>");});};K.t=function(b8){return b8?g.GetOrLoadTemplate("todoapp",null,function(){return _8.ParseHTMLIntoFakeRoot("<section class=\"todoapp\" ws-chidlren-template=\"TodoApp\">\r\n    <header class=\"header\">\r\n        <h1>todos</h1>\r\n        <input class=\"new-todo\" ws-var=\"NewTask\" ws-onkeyup=\"Add\" placeholder=\"What needs to be done?\" autofocus=\"\">\r\n    </header>\r\n    <section class=\"main\">\r\n        <span ws-replace=\"ToggleAll\"></span>\r\n        <label for=\"toggle-all\">Mark all as complete</label>\r\n        <ul class=\"todo-list\" ws-hole=\"TodoList\">\r\n            \r\n        </ul>\r\n    </section>\r\n    <div ws-replace=\"Footer\">\r\n        \r\n    </div>\r\n</section>\r\n<footer class=\"info\">\r\n    <p>Double-click to edit a todo</p>\r\n    <p>Written by <a href=\"https://github.com/SimonJF\">Simon Fowler</a> and <a href=\"https://github.com/qwe2\">István Gansperger</a></p>\r\n</footer>\r\n\r\n");},b8):g.PrepareTemplate("todoapp",null,function(){return _8.ParseHTMLIntoFakeRoot("<section class=\"todoapp\" ws-chidlren-template=\"TodoApp\">\r\n    <header class=\"header\">\r\n        <h1>todos</h1>\r\n        <input class=\"new-todo\" ws-var=\"NewTask\" ws-onkeyup=\"Add\" placeholder=\"What needs to be done?\" autofocus=\"\">\r\n    </header>\r\n    <section class=\"main\">\r\n        <span ws-replace=\"ToggleAll\"></span>\r\n        <label for=\"toggle-all\">Mark all as complete</label>\r\n        <ul class=\"todo-list\" ws-hole=\"TodoList\">\r\n            \r\n        </ul>\r\n    </section>\r\n    <div ws-replace=\"Footer\">\r\n        \r\n    </div>\r\n</section>\r\n<footer class=\"info\">\r\n    <p>Double-click to edit a todo</p>\r\n    <p>Written by <a href=\"https://github.com/SimonJF\">Simon Fowler</a> and <a href=\"https://github.com/qwe2\">István Gansperger</a></p>\r\n</footer>\r\n\r\n");});};K.listitem=function(b8){return b8?g.GetOrLoadTemplate("todoapp",{$:1,$0:"listitem"},function(){return _8.ParseHTMLIntoFakeRoot("<li class=\"${ItemState}\">\r\n                <div class=\"view\">\r\n                    <input class=\"toggle\" ws-var=\"Checked\" type=\"checkbox\">\r\n                    <label ws-ondblclick=\"Edit\">${Title}</label>\r\n                    <button class=\"destroy\" ws-onclick=\"Destroy\"></button>\r\n                </div>\r\n                <div ws-replace=\"TitleEditing\"></div>\r\n            </li>");},b8):g.PrepareTemplate("todoapp",{$:1,$0:"listitem"},function(){return _8.ParseHTMLIntoFakeRoot("<li class=\"${ItemState}\">\r\n                <div class=\"view\">\r\n                    <input class=\"toggle\" ws-var=\"Checked\" type=\"checkbox\">\r\n                    <label ws-ondblclick=\"Edit\">${Title}</label>\r\n                    <button class=\"destroy\" ws-onclick=\"Destroy\"></button>\r\n                </div>\r\n                <div ws-replace=\"TitleEditing\"></div>\r\n            </li>");});};x=e.ListModel=b4.Class({UpdateAll:function(b8){var b9;b9=this;this["var"].Update(function(b_){G.iteri(function(b$,ca){var cb;cb=b8(ca);return cb==null?null:G.set(b_,b$,cb.$0);},b_);return b9.storage.SSet(b_);});this.ObsoleteAll();},TryFind:function(b8){return G.tryFind(b8,this["var"].Get());},RemoveBy:function(b8){var b9,b_,b$,ca;b9=this["var"].Get();for(b_=0,b$=b9.length-1;b_<=b$;b_++){ca=G.get(b9,b_);if(b8(ca))this.ObsoleteKey(this.key(ca));}this["var"].Set(this.storage.SRemoveIf(b8,this["var"].Get()));},Append:function(b8){var b9,b_,b$,ca;b9=this;b_=this["var"].Get();b$=this.key(b8);ca=G.tryFindIndex(function(cb){return s.Equals(b9.key(cb),b$);},b_);if(ca!=null&&ca.$==1)this["var"].Set(this.storage.SSetAt(ca.$0,b8,b_));else this["var"].Set(this.storage.SAppend(b8,b_));this.ObsoleteKey(b$);},RemoveByKey:function(b8){var b9;b9=this;this["var"].Set(this.storage.SRemoveIf(function(b_){return s.Equals(b9.key(b_),b8);},this["var"].Get()));this.ObsoleteKey(b8);},ObsoleteAll:function(){N.iter(function(b8){V.Obsolete(b8.V);},this.it);this.it.Clear();},ObsoleteKey:function(b8){var b9,b_;b9=(b_=null,[this.it.TryGetValue(b8,{get:function(){return b_;},set:function(b$){b_=b$;}}),b_]);if(b9[0]){V.Obsolete(b9[1]);this.it.Remove(b8);}},MapLens:function(b8){var b9;b9=this;return J.MapSeqCachedViewBy(b9.key,function(b_,b$){return b8(b_,b9["LensInto'"](a.id,function(ca,cb){return cb;},b_,b$));},this["var"].get_View());},"LensInto'":function(b8,b9,b_,b$){var ca,cb,cc;ca=this;cb=bi.Id();cc=new B({Get:function(){return b8(ca.FindByKey(b_));},Set:function(cd){return ca.UpdateBy(function(ce){return{$:1,$0:b9(ce,cd)};},b_);},SetFinal:function(cd){return this.Set(cd);},Update:function(cd){return ca.UpdateBy(function(ce){return{$:1,$0:b9(ce,cd(b8(ce)))};},b_);},UpdateMaybe:function(cd){return ca.UpdateBy(function(ce){var cf;cf=cd(b8(ce));return cf==null?null:{$:1,$0:b9(ce,cf.$0)};},b_);},get_View:function(){return b$;},get_Id:function(){return cb;}});B.New.call(cc);return cc;},FindByKey:function(b8){var b9;b9=this;return G.find(function(b_){return s.Equals(b9.key(b_),b8);},this["var"].Get());},UpdateBy:function(b8,b9){var b_,b$,ca,cb,cc;b_=this;b$=this["var"].Get();ca=G.tryFindIndex(function(cd){return s.Equals(b_.key(cd),b9);},b$);if(ca!=null&&ca.$==1){cb=ca.$0;cc=b8(G.get(b$,cb));cc!=null&&cc.$==1?(this["var"].Set(this.storage.SSetAt(cb,cc.$0,b$)),this.ObsoleteKey(b9)):void 0;}},GetEnumerator:function(){return _9.Get(this["var"].Get());},GetEnumerator0:function(){return _9.Get0(this["var"].Get());}},h,x);x.New=b4.Ctor(function(b8,b9){x.New$3.call(this,b8,z.Create$1(G.ofSeq(N.distinctBy(b8,b9.SInit()))),b9);},x);x.New$3=b4.Ctor(function(b8,b9,b_){h.New.call(this);this.key=b8;this["var"]=b9;this.storage=b_;this.v=J.Map(function(b$){return b$.slice();},this["var"].get_View());this.it=new r.New$5();},x);L.$cctor=function(){L.$cctor=a.ignore;L.LoadedTemplates=new r.New$5();L.LocalTemplatesLoaded=false;L.GlobalHoles=new r.New$5();L.TextHoleRE="\\${([^}]+)}";L.RenderedFullDocTemplate=null;};M=q.HashSet=b4.Class({Add:function(b8){return this.add(b8);},Contains:function(b8){var b9;b9=this.data[this.hash(b8)];return b9==null?false:this.arrContains(b8,b9);},add:function(b8){var b9,b_;b9=this.hash(b8);b_=this.data[b9];return b_==null?(this.data[b9]=[b8],this.count=this.count+1,true):this.arrContains(b8,b_)?false:(b_.push(b8),this.count=this.count+1,true);},arrContains:function(b8,b9){var b_,b$,ca,cb;b_=true;b$=0;cb=b9.length;while(b_&&b$<cb)if(this.equals.apply(null,[b9[b$],b8]))b_=false;else b$=b$+1;return!b_;},ExceptWith:function(b8){var b9;b9=_9.Get(b8);try{while(b9.MoveNext())this.Remove(b9.Current());}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(b8){var b9,b_,b$,ca;b9=0;b_=bK.concat(this.data);for(b$=0,ca=b_.length-1;b$<=ca;b$++)G.set(b8,b$,b_[b$]);},IntersectWith:function(b8){var b9,b_,b$,ca,cb;b9=new M.New$4(b8,this.equals,this.hash);b_=bK.concat(this.data);for(b$=0,ca=b_.length-1;b$<=ca;b$++){cb=b_[b$];if(!b9.Contains(cb))this.Remove(cb);}},Remove:function(b8){var b9;b9=this.data[this.hash(b8)];return b9==null?false:this.arrRemove(b8,b9)&&(this.count=this.count-1,true);},arrRemove:function(b8,b9){var b_,b$,ca,cb;b_=true;b$=0;cb=b9.length;while(b_&&b$<cb)if(this.equals.apply(null,[b9[b$],b8])){b9.splice.apply(b9,[b$,1]);b_=false;}else b$=b$+1;return!b_;},GetEnumerator:function(){return _9.Get(bK.concat(this.data));},GetEnumerator0:function(){return _9.Get(bK.concat(this.data));}},h,M);M.New$3=b4.Ctor(function(){M.New$4.call(this,[],s.Equals,s.Hash);},M);M.New$4=b4.Ctor(function(b8,b9,b_){var b$;h.New.call(this);this.equals=b9;this.hash=b_;this.data=[];this.count=0;b$=_9.Get(b8);try{while(b$.MoveNext())this.add(b$.Current());}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}},M);M.New$2=b4.Ctor(function(b8){M.New$4.call(this,b8,s.Equals,s.Hash);},M);N.head=function(b8){var b9;b9=_9.Get(b8);try{return b9.MoveNext()?b9.Current():N.insufficient();}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}};N.sumBy=function(b8,b9){return N.fold(function(b_,b$){return b_+b8(b$);},0,b9);};N.isEmpty=function(b8){var b9;b9=_9.Get(b8);try{return!b9.MoveNext();}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}};N.exists=function(b8,b9){var b_,b$;b_=_9.Get(b9);try{b$=false;while(!b$&&b_.MoveNext())b$=b8(b_.Current());return b$;}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}};N.fold=function(b8,b9,b_){var b$,ca;b$=b9;ca=_9.Get(b_);try{while(ca.MoveNext())b$=b8(b$,ca.Current());return b$;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}};N.delay=function(b8){return{GetEnumerator:function(){return _9.Get(b8());}};};N.append=function(b8,b9){return{GetEnumerator:function(){var b_,b$;b_=_9.Get(b8);b$=[true];return new bz.New(b_,null,function(ca){var cb;return ca.s.MoveNext()?(ca.c=ca.s.Current(),true):(cb=ca.s,!s.Equals(cb,null)?cb.Dispose():void 0,ca.s=null,b$[0]&&(b$[0]=false,ca.s=_9.Get(b9),ca.s.MoveNext()?(ca.c=ca.s.Current(),true):(ca.s.Dispose(),ca.s=null,false)));},function(ca){var cb;cb=ca.s;if(!s.Equals(cb,null))cb.Dispose();});}};};N.distinctBy=function(b8,b9){return{GetEnumerator:function(){var b_,b$;b_=_9.Get(b9);b$=new M.New$3();return new bz.New(null,null,function(ca){var cb,cc;if(b_.MoveNext()){cb=b_.Current();cc=b$.Add(b8(cb));while(!cc&&b_.MoveNext()){cb=b_.Current();cc=b$.Add(b8(cb));}return cc&&(ca.c=cb,true);}else return false;},function(){b_.Dispose();});}};};N.map=function(b8,b9){return{GetEnumerator:function(){var b_;b_=_9.Get(b9);return new bz.New(null,null,function(b$){return b_.MoveNext()&&(b$.c=b8(b_.Current()),true);},function(){b_.Dispose();});}};};N.iter=function(b8,b9){var b_;b_=_9.Get(b9);try{while(b_.MoveNext())b8(b_.Current());}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}};N.rev=function(b8){return N.delay(function(){return G.ofSeq(b8).slice().reverse();});};N.forall2=function(b8,b9,b_){return!N.exists2(function(b$,ca){return!b8(b$,ca);},b9,b_);};N.distinct=function(b8){return N.distinctBy(a.id,b8);};N.exists2=function(b8,b9,b_){var b$,ca,cb,cc;b$=_9.Get(b9);try{cb=_9.Get(b_);try{cc=false;while(!cc&&b$.MoveNext()&&cb.MoveNext())cc=b8(b$.Current(),cb.Current());ca=cc;}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};N.max=function(b8){var b9,b_,b$;b9=_9.Get(b8);try{if(!b9.MoveNext())N.seqEmpty();b_=b9.Current();while(b9.MoveNext()){b$=b9.Current();if(s.Compare(b$,b_)===1)b_=b$;}return b_;}finally{if(typeof b9=="object"&&"Dispose"in b9)b9.Dispose();}};N.seqEmpty=function(){return m.FailWith("The input sequence was empty.");};N.forall=function(b8,b9){return!N.exists(function(b_){return!b8(b_);},b9);};N.unfold=function(b8,b9){return{GetEnumerator:function(){return new bz.New(b9,null,function(b_){var b$;b$=b8(b_.s);return b$==null?false:(b_.c=b$.$0[0],b_.s=b$.$0[1],true);},void 0);}};};N.compareWith=function(b8,b9,b_){var b$,ca,cb,cc,cd;b$=_9.Get(b9);try{cb=_9.Get(b_);try{cc=0;cd=true;while(cd&&cc===0)if(b$.MoveNext())cc=cb.MoveNext()?b8(b$.Current(),cb.Current()):1;else if(cb.MoveNext())cc=-1;else cd=false;ca=cc;}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};J=e.View=b4.Class({},null,J);P.LinkElement=function(b8,b9){P.InsertDoc(b8,b9,null);};P.InsertDoc=function(b8,b9,b_){var b$,ca,cb;while(true)if(b9!=null&&b9.$==1)return P.InsertNode(b8,b9.$0.El,b_);else if(b9!=null&&b9.$==2){b$=b9.$0;b$.Dirty=false;b9=b$.Current;}else if(b9==null)return b_;else if(b9!=null&&b9.$==4)return P.InsertNode(b8,b9.$0.Text,b_);else if(b9!=null&&b9.$==5)return P.InsertNode(b8,b9.$0,b_);else if(b9!=null&&b9.$==6)return G.foldBack(function(cc,cd){return(((b4.Curried3(function(ce,cf,cg){return cf==null||cf.constructor===_5?P.InsertDoc(ce,cf,cg):P.InsertNode(ce,cf,cg);}))(b8))(cc))(cd);},b9.$0.Els,b_);else{ca=b9.$1;cb=b9.$0;b9=cb;b_=P.InsertDoc(b8,ca,b_);}};P.CreateRunState=function(b8,b9){return bq.New(br.get_Empty(),P.CreateElemNode(b8,_0.EmptyAttr(),b9));};P.PerformAnimatedUpdate=function(b8,b9,b_){var b$;return bb.get_UseAnimations()?(b$=null,bs.Delay(function(){var ca,cb,cc;ca=br.FindAll(b_);cb=P.ComputeChangeAnim(b9,ca);cc=P.ComputeEnterAnim(b9,ca);return bs.Bind(bb.Play(bb.Append(cb,P.ComputeExitAnim(b9,ca))),function(){return bs.Bind(P.SyncElemNodesNextFrame(b8,b9),function(){return bs.Bind(bb.Play(cc),function(){b9.PreviousNodes=ca;return bs.Return(null);});});});})):P.SyncElemNodesNextFrame(b8,b9);};P.PerformSyncUpdate=function(b8,b9,b_){var b$;b$=br.FindAll(b_);P.SyncElemNode(b8,b9.Top);b9.PreviousNodes=b$;};P.CreateEmbedNode=function(){return{Current:null,Dirty:false};};P.UpdateEmbedNode=function(b8,b9){b8.Current=b9;b8.Dirty=true;};P.InsertNode=function(b8,b9,b_){_8.InsertAt(b8,b_,b9);return b9;};P.CreateElemNode=function(b8,b9,b_){var b$;P.LinkElement(b8,b_);b$=_0.Insert(b8,b9);return $.New(b$,b_,null,b8,bi.Int(),b4.GetOptional(b$.OnAfterRender));};P.SyncElemNodesNextFrame=function(b8,b9){function b_(b$){a.requestAnimationFrame(function(){P.SyncElemNode(b8,b9.Top);b$();});}return bc.BatchUpdatesEnabled()?bs.FromContinuations(function(b$,ca,cb){return b_.apply(null,[b$,ca,cb]);}):(P.SyncElemNode(b8,b9.Top),bs.Return(null));};P.ComputeExitAnim=function(b8,b9){return bb.Concat(G.map(function(b_){return _0.GetExitAnim(b_.Attr);},br.ToArray(br.Except(b9,br.Filter(function(b_){return _0.HasExitAnim(b_.Attr);},b8.PreviousNodes)))));};P.ComputeEnterAnim=function(b8,b9){return bb.Concat(G.map(function(b_){return _0.GetEnterAnim(b_.Attr);},br.ToArray(br.Except(b8.PreviousNodes,br.Filter(function(b_){return _0.HasEnterAnim(b_.Attr);},b9)))));};P.ComputeChangeAnim=function(b8,b9){var b_;function b$(ca){return _0.HasChangeAnim(ca.Attr);}b_=function(ca){return br.Filter(b$,ca);};return bb.Concat(G.map(function(ca){return _0.GetChangeAnim(ca.Attr);},br.ToArray(br.Intersect(b_(b8.PreviousNodes),b_(b9)))));};P.SyncElemNode=function(b8,b9){!b8?P.SyncElement(b9):void 0;P.Sync(b9.Children);P.AfterRender(b9);};P.SyncElement=function(b8){function b9(b_){function b$(ca){var cb,cc,cd,ce;while(true){if(ca!=null&&ca.$==0){cc=ca.$1;cd=ca.$0;if(b$(cd))return true;else ca=cc;}else if(ca!=null&&ca.$==2){ce=ca.$0;if(ce.Dirty)return true;else ca=ce.Current;}else return ca!=null&&ca.$==6&&(cb=ca.$0,cb.Dirty||G.exists(b9,cb.Holes));}}return b$(b_.Children);}_0.Sync(b8.El,b8.Attr);if(b9(b8))P.DoSyncElement(b8);};P.Sync=function(b8){var b9,b_,b$,ca,cb;while(true){if(b8!=null&&b8.$==1)return P.SyncElemNode(false,b8.$0);else if(b8!=null&&b8.$==2){b$=b8.$0;b8=b$.Current;}else if(b8==null)return null;else if(b8!=null&&b8.$==5)return null;else if(b8!=null&&b8.$==4){b9=b8.$0;return b9.Dirty?(b9.Text.nodeValue=b9.Value,b9.Dirty=false):null;}else if(b8!=null&&b8.$==6){b_=b8.$0;G.iter(function(cc){return function(cd){P.SyncElemNode(cc,cd);};}(false),b_.Holes);G.iter(function(cc){_0.Sync(cc[0],cc[1]);},b_.Attrs);return P.AfterRender(b_);}else{ca=b8.$1;cb=b8.$0;P.Sync(cb);b8=ca;}}};P.AfterRender=function(b8){var b9;b9=b4.GetOptional(b8.Render);if(b9!=null&&b9.$==1){b9.$0(b8.El);b4.SetOptional(b8,"Render",null);}};P.DoSyncElement=function(b8){var b9,b_,b$;function ca(cb,cc){var cd,ce,cf,cg;while(true){if(cb!=null&&cb.$==1)return cb.$0.El;else if(cb!=null&&cb.$==2){ce=cb.$0;if(ce.Dirty){ce.Dirty=false;return P.InsertDoc(b9,ce.Current,cc);}else cb=ce.Current;}else if(cb==null)return cc;else if(cb!=null&&cb.$==4)return cb.$0.Text;else if(cb!=null&&cb.$==5)return cb.$0;else if(cb!=null&&cb.$==6){cd=cb.$0;cd.Dirty?cd.Dirty=false:void 0;return G.foldBack(function(ch,ci){return ch==null||ch.constructor===_5?ca(ch,ci):ch;},cd.Els,cc);}else{cf=cb.$1;cg=cb.$0;cb=cg;cc=ca(cf,cc);}}}b9=b8.El;bU.Iter((b_=b8.El,function(cb){_8.RemoveNode(b_,cb);}),bU.Except(bU.DocChildren(b8),bU.Children(b8.El,b4.GetOptional(b8.Delimiters))));ca(b8.Children,(b$=b4.GetOptional(b8.Delimiters),b$!=null&&b$.$==1?b$.$0[1]:null));};P.InsertBeforeDelim=function(b8,b9){var b_,b$;b_=b8.parentNode;b$=self.document.createTextNode("");b_.insertBefore(b$,b8);P.LinkPrevElement(b8,b9);return b$;};P.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};P.UpdateTextNode=function(b8,b9){b8.Value=b9;b8.Dirty=true;};P.LinkPrevElement=function(b8,b9){P.InsertDoc(b8.parentNode,b9,b8);};Q.OfArray=function(b8){return new bf.New$1(bE.OfSeq(N.map(function(b9){return bG.New(b9[0],b9[1]);},b8)));};R.InMemory=function(b8){return new bg.New(b8);};S.TryParseInt32=function(b8,b9){return S.TryParse(b8,-2147483648,2147483647,b9);};T.InstallMap=function(b8){var b9;function b_(cc,cd){return s.Equals(b8.Ser(cc),b8.Ser(cd));}function b$(){return b8.Des(bh.ToList(bh.ParseHash(self.location.hash)));}function ca(cc){if(!b_(b9.Get(),cc))b9.Set(cc);}function cb(cc){return ca(b$());}b9=z.Create$1(b$());self.onpopstate=cb;self.onhashchange=cb;J.Sink(function(cc){var cd,ce;cd=bh.MakeHash((ce=b8.Ser(cc),bh.FromList(ce[0],ce[1])));if(!bh.SameHash(self.location.hash,cd))self.location.replace("#"+cd);},b9.get_View());return b9;};U=e.ConcreteVar=b4.Class({get_View:function(){return this.view;},Set:function(b8){if(this.isConst)(function(b9){return b9("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b9){b5.log(b9);}));else{V.Obsolete(this.snap);this.current=b8;this.snap=V.New({$:2,$0:b8,$1:[]});}},Get:function(){return this.current;},Update:function(b8){this.Set(b8(this.Get()));},UpdateMaybe:function(b8){var b9;b9=b8(this.Get());if(b9!=null&&b9.$==1)this.Set(b9.$0);}},B,U);U.New=b4.Ctor(function(b8,b9,b_){var b$;b$=this;B.New.call(this);this.isConst=b8;this.current=b_;this.snap=b9;this.view=function(){return b$.snap;};this.id=bi.Int();},U);V.Map=function(b8,b9){var b_,b$;b_=b9.s;return b_!=null&&b_.$==0?V.New({$:0,$0:b8(b_.$0)}):(b$=V.New({$:3,$0:[],$1:[]}),(V.When(b9,function(ca){V.MarkDone(b$,b9,b8(ca));},b$),b$));};V.WhenObsoleteRun=function(b8,b9){var b_;b_=b8.s;if(b_==null)b9();else b_!=null&&b_.$==2?b_.$1.push(b9):b_!=null&&b_.$==3?b_.$1.push(b9):void 0;};V.When=function(b8,b9,b_){var b$;b$=b8.s;if(b$==null)V.Obsolete(b_);else b$!=null&&b$.$==2?(V.EnqueueSafe(b$.$1,b_),b9(b$.$0)):b$!=null&&b$.$==3?(b$.$0.push(b9),V.EnqueueSafe(b$.$1,b_)):b9(b$.$0);};V.MarkDone=function(b8,b9,b_){var b$;if(b$=b9.s,b$!=null&&b$.$==0)V.MarkForever(b8,b_);else V.MarkReady(b8,b_);};V.WhenRun=function(b8,b9,b_){var b$;b$=b8.s;if(b$==null)b_();else b$!=null&&b$.$==2?(b$.$1.push(b_),b9(b$.$0)):b$!=null&&b$.$==3?(b$.$0.push(b9),b$.$1.push(b_)):b9(b$.$0);};V.Map2=function(b8,b9,b_){var b$,ca,cb;function cc(cd){var ce,cf,cg;if(!(ce=cb.s,ce!=null&&ce.$==0||ce!=null&&ce.$==2)){cf=V.ValueAndForever(b9);cg=V.ValueAndForever(b_);if(cf!=null&&cf.$==1)cg!=null&&cg.$==1?cf.$0[1]&&cg.$0[1]?V.MarkForever(cb,b8(cf.$0[0],cg.$0[0])):V.MarkReady(cb,b8(cf.$0[0],cg.$0[0])):void 0;}}b$=b9.s;ca=b_.s;return b$!=null&&b$.$==0?ca!=null&&ca.$==0?V.New({$:0,$0:b8(b$.$0,ca.$0)}):V.Map2Opt1(b8,b$.$0,b_):ca!=null&&ca.$==0?V.Map2Opt2(b8,ca.$0,b9):(cb=V.New({$:3,$0:[],$1:[]}),(V.When(b9,cc,cb),V.When(b_,cc,cb),cb));};V.EnqueueSafe=function(b8,b9){var b_,b$,ca,cb;b8.push(b9);if(b8.length%20===0){b_=b8.slice(0);bR.Clear(b8);for(b$=0,ca=G.length(b_)-1;b$<=ca;b$++){cb=G.get(b_,b$);if(typeof cb=="object")(function(cc){if(cc.s)b8.push(cc);}(cb));else(function(cc){b8.push(cc);}(cb));}}else void 0;};V.MarkForever=function(b8,b9){var b_,b$,ca,cb;b_=b8.s;if(b_!=null&&b_.$==3){b8.s={$:0,$0:b9};b$=b_.$0;for(ca=0,cb=G.length(b$)-1;ca<=cb;ca++)(G.get(b$,ca))(b9);}else void 0;};V.MarkReady=function(b8,b9){var b_,b$,ca,cb;b_=b8.s;if(b_!=null&&b_.$==3){b8.s={$:2,$0:b9,$1:b_.$1};b$=b_.$0;for(ca=0,cb=G.length(b$)-1;ca<=cb;ca++)(G.get(b$,ca))(b9);}else void 0;};V.Map2Opt1=function(b8,b9,b_){return V.Map(function(b$){return b8(b9,b$);},b_);};V.Map2Opt2=function(b8,b9,b_){return V.Map(function(b$){return b8(b$,b9);},b_);};V.ValueAndForever=function(b8){var b9;b9=b8.s;return b9!=null&&b9.$==0?{$:1,$0:[b9.$0,true]}:b9!=null&&b9.$==2?{$:1,$0:[b9.$0,false]}:null;};V.Join=function(b8){var b9;b9=V.New({$:3,$0:[],$1:[]});V.When(b8,function(b_){var b$;b$=b_();V.When(b$,function(ca){var cb,cc;if((cb=b$.s,cb!=null&&cb.$==0)&&(cc=b8.s,cc!=null&&cc.$==0))V.MarkForever(b9,ca);else V.MarkReady(b9,ca);},b9);},b9);return b9;};V.Map2Unit=function(b8,b9){var b_,b$,ca;function cb(){var cc,cd,ce;if(!(cc=ca.s,cc!=null&&cc.$==0||cc!=null&&cc.$==2)){cd=V.ValueAndForever(b8);ce=V.ValueAndForever(b9);if(cd!=null&&cd.$==1)ce!=null&&ce.$==1?cd.$0[1]&&ce.$0[1]?V.MarkForever(ca,null):V.MarkReady(ca,null):void 0;}}b_=b8.s;b$=b9.s;return b_!=null&&b_.$==0?b$!=null&&b$.$==0?V.New({$:0,$0:null}):b9:b$!=null&&b$.$==0?b8:(ca=V.New({$:3,$0:[],$1:[]}),(V.When(b8,cb,ca),V.When(b9,cb,ca),ca));};V.Copy=function(b8){var b9,b_,b$;b9=b8.s;return b9==null?b8:b9!=null&&b9.$==2?(b_=V.New({$:2,$0:b9.$0,$1:[]}),(V.WhenObsolete(b8,b_),b_)):b9!=null&&b9.$==3?(b$=V.New({$:3,$0:[],$1:[]}),(V.When(b8,function(ca){V.MarkDone(b$,b8,ca);},b$),b$)):b8;};V.WhenObsolete=function(b8,b9){var b_;b_=b8.s;if(b_==null)V.Obsolete(b9);else b_!=null&&b_.$==2?V.EnqueueSafe(b_.$1,b9):b_!=null&&b_.$==3?V.EnqueueSafe(b_.$1,b9):void 0;};V.Map3=function(b8,b9,b_,b$){var ca,cb,cc,cd;function ce(cf){var cg,ch,ci,cj;if(!(cg=cd.s,cg!=null&&cg.$==0||cg!=null&&cg.$==2)){ch=V.ValueAndForever(b9);ci=V.ValueAndForever(b_);cj=V.ValueAndForever(b$);if(ch!=null&&ch.$==1)ci!=null&&ci.$==1?cj!=null&&cj.$==1?ch.$0[1]&&ci.$0[1]&&cj.$0[1]?V.MarkForever(cd,b8(ch.$0[0],ci.$0[0],cj.$0[0])):V.MarkReady(cd,b8(ch.$0[0],ci.$0[0],cj.$0[0])):void 0:void 0;}}ca=b9.s;cb=b_.s;cc=b$.s;return ca!=null&&ca.$==0?cb!=null&&cb.$==0?cc!=null&&cc.$==0?V.New({$:0,$0:b8(ca.$0,cb.$0,cc.$0)}):V.Map3Opt1(b8,ca.$0,cb.$0,b$):cc!=null&&cc.$==0?V.Map3Opt2(b8,ca.$0,cc.$0,b_):V.Map3Opt3(b8,ca.$0,b_,b$):cb!=null&&cb.$==0?cc!=null&&cc.$==0?V.Map3Opt4(b8,cb.$0,cc.$0,b9):V.Map3Opt5(b8,cb.$0,b9,b$):cc!=null&&cc.$==0?V.Map3Opt6(b8,cc.$0,b9,b_):(cd=V.New({$:3,$0:[],$1:[]}),(V.When(b9,ce,cd),V.When(b_,ce,cd),V.When(b$,ce,cd),cd));};V.Sequence=function(b8){var b9,b_,b$;function ca(cb){var cc;if(b$[0]===0){cc=G.map(function(cd){var ce;ce=cd.s;return ce!=null&&ce.$==0?ce.$0:ce!=null&&ce.$==2?ce.$0:m.FailWith("value not found by View.Sequence");},b9);if(G.forall(function(cd){var ce;ce=cd.s;return ce!=null&&ce.$==0;},b9))V.MarkForever(b_,cc);else V.MarkReady(b_,cc);}else b$[0]--;}b9=G.ofSeq(b8);return b9.length==0?V.New({$:0,$0:[]}):(b_=V.New({$:3,$0:[],$1:[]}),(b$=[G.length(b9)-1],(G.iter(function(cb){V.When(cb,ca,b_);},b9),b_)));};V.Map3Opt1=function(b8,b9,b_,b$){return V.Map(function(ca){return b8(b9,b_,ca);},b$);};V.Map3Opt2=function(b8,b9,b_,b$){return V.Map(function(ca){return b8(b9,ca,b_);},b$);};V.Map3Opt3=function(b8,b9,b_,b$){return V.Map2(function(ca,cb){return b8(b9,ca,cb);},b_,b$);};V.Map3Opt4=function(b8,b9,b_,b$){return V.Map(function(ca){return b8(ca,b9,b_);},b$);};V.Map3Opt5=function(b8,b9,b_,b$){return V.Map2(function(ca,cb){return b8(ca,b9,cb);},b_,b$);};V.Map3Opt6=function(b8,b9,b_,b$){return V.Map2(function(ca,cb){return b8(ca,cb,b9);},b_,b$);};X.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b8){var b9,b_;b9=b6.random()*16|0;b_=b8=="x"?b9:b9&3|8;return b_.toString(16);});};Y=q.List=b4.Class({GetEnumerator:function(){return _9.Get(this);},GetEnumerator0:function(){return _9.Get0(this);}},null,Y);Z=e.AttrProxy=b4.Class({},null,Z);Z.Create=function(b8,b9){return _0.Static(function(b_){b_.setAttribute(b8,b9);});};Z.Concat=function(b8){var b9;b9=bl.ofSeqNonCopying(b8);return bl.TreeReduce(_0.EmptyAttr(),Z.Append,b9);};Z.Append=function(b8,b9){return _0.AppendTree(b8,b9);};Z.Handler=function(b8,b9){return Z.HandlerImpl(b8,b9);};Z.HandlerImpl=function(b8,b9){return _0.Static(function(b_){b_.addEventListener(b8,function(b$){return(b9(b_))(b$);},false);});};_0.Static=function(b8){return new Z({$:3,$0:b8});};_0.Dynamic=function(b8,b9){return new Z({$:1,$0:new bx.New(b8,b9)});};_0.AppendTree=function(b8,b9){var b_;return b8===null?b9:b9===null?b8:(b_=new Z({$:2,$0:b8,$1:b9}),(_0.SetFlags(b_,_0.Flags(b8)|_0.Flags(b9)),b_));};_0.Insert=function(b8,b9){var b_,b$,ca;function cb(cc){var cd,ce;while(true)if(!(cc===null)){if(cc!=null&&cc.$==1)return b_.push(cc.$0);else if(cc!=null&&cc.$==2){cd=cc.$1;ce=cc.$0;cb(ce);cc=cd;}else return cc!=null&&cc.$==3?cc.$0(b8):cc!=null&&cc.$==4?b$.push(cc.$0):null;}else return null;}b_=[];b$=[];cb(b9);ca=b_.slice(0);return bo.New(b8,_0.Flags(b9),ca,b$.length===0?null:{$:1,$0:function(cc){N.iter(function(cd){cd(cc);},b$);}});};_0.EmptyAttr=function(){bI.$cctor();return bI.EmptyAttr;};_0.HasExitAnim=function(b8){var b9;b9=2;return(b8.DynFlags&b9)===b9;};_0.GetExitAnim=function(b8){return _0.GetAnim(b8,function(b9,b_){return b9.NGetExitAnim(b_);});};_0.HasEnterAnim=function(b8){var b9;b9=1;return(b8.DynFlags&b9)===b9;};_0.GetEnterAnim=function(b8){return _0.GetAnim(b8,function(b9,b_){return b9.NGetEnterAnim(b_);});};_0.HasChangeAnim=function(b8){var b9;b9=4;return(b8.DynFlags&b9)===b9;};_0.GetChangeAnim=function(b8){return _0.GetAnim(b8,function(b9,b_){return b9.NGetChangeAnim(b_);});};_0.Updates=function(b8){return bl.MapTreeReduce(function(b9){return b9.NChanged();},J.Const(),J.Map2Unit,b8.DynNodes);};_0.SetFlags=function(b8,b9){b8.flags=b9;};_0.Flags=function(b8){return b8!==null&&b8.hasOwnProperty("flags")?b8.flags:0;};_0.GetAnim=function(b8,b9){return bb.Concat(G.map(function(b_){return b9(b_,b8.DynElem);},b8.DynNodes));};_0.Sync=function(b8,b9){G.iter(function(b_){b_.NSync(b8);},b9.DynNodes);};_0.Empty=function(b8){return bo.New(b8,0,[],null);};_3.Trim=function(b8){return b8.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};_3.concat=function(b8,b9){return G.ofSeq(b9).join(b8);};_3.SplitChars=function(b8,b9,b_){return _3.Split(b8,new a.RegExp("["+_3.RegexEscape(b9.join(""))+"]"),b_);};_3.StartsWith=function(b8,b9){return b8.substring(0,b9.length)==b9;};_3.Split=function(b8,b9,b_){return b_===1?G.filter(function(b$){return b$!=="";},_3.SplitWith(b8,b9)):_3.SplitWith(b8,b9);};_3.RegexEscape=function(b8){return b8.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};_3.SplitWith=function(b8,b9){return b8.split(b9);};_3.forall=function(b8,b9){return N.forall(b8,_3.protect(b9));};_3.protect=function(b8){return b8===null?"":b8;};_4.notPresent=function(){return m.FailWith("The given key was not present in the dictionary.");};G.exists=function(b8,b9){var b_,b$,ca,cb;b_=false;b$=0;cb=G.length(b9);while(!b_&&b$<cb)if(b8(b9[b$]))b_=true;else b$=b$+1;return b_;};G.tryPick=function(b8,b9){var b_,b$,ca;b_=null;b$=0;while(b$<b9.length&&b_==null){ca=b8(b9[b$]);if(ca!=null&&ca.$==1)b_=ca;b$=b$+1;}return b_;};G.tryFindIndex=function(b8,b9){var b_,b$;b_=null;b$=0;while(b$<b9.length&&b_==null){b8(b9[b$])?b_={$:1,$0:b$}:void 0;b$=b$+1;}return b_;};G.ofSeq=function(b8){var b9,b_;if(b8 instanceof a.Array)return b8.slice();else if(b8 instanceof w)return G.ofList(b8);else{b9=[];b_=_9.Get(b8);try{while(b_.MoveNext())b9.push(b_.Current());return b9;}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}}};G.iteri=function(b8,b9){var b_,b$;for(b_=0,b$=b9.length-1;b_<=b$;b_++)b8(b_,b9[b_]);};G.tryFind=function(b8,b9){var b_,b$;b_=null;b$=0;while(b$<b9.length&&b_==null){b8(b9[b$])?b_={$:1,$0:b9[b$]}:void 0;b$=b$+1;}return b_;};G.choose=function(b8,b9){var b_,b$,ca,cb;b_=[];for(b$=0,ca=b9.length-1;b$<=ca;b$++){cb=b8(b9[b$]);if(cb==null);else b_.push(cb.$0);}return b_;};G.filter=function(b8,b9){var b_,b$,ca;b_=[];for(b$=0,ca=b9.length-1;b$<=ca;b$++)if(b8(b9[b$]))b_.push(b9[b$]);return b_;};G.map=function(b8,b9){var b_,b$,ca;b_=new a.Array(b9.length);for(b$=0,ca=b9.length-1;b$<=ca;b$++)b_[b$]=b8(b9[b$]);return b_;};G.iter=function(b8,b9){var b_,b$;for(b_=0,b$=b9.length-1;b_<=b$;b_++)b8(b9[b_]);};G.foldBack=function(b8,b9,b_){var b$,ca,cb,cc,cd;b$=b_;cb=b9.length;for(cc=1,cd=cb;cc<=cd;cc++)b$=b8(b9[cb-cc],b$);return b$;};G.ofList=function(b8){var b9,b_;b_=[];b9=b8;while(!(b9.$==0)){b_.push(v.head(b9));b9=v.tail(b9);}return b_;};G.pick=function(b8,b9){var b_;b_=G.tryPick(b8,b9);return b_==null?m.FailWith("KeyNotFoundException"):b_.$0;};G.sortInPlace=function(b8){G.mapInPlace(function(b9){return b9[0];},G.mapiInPlace(function(b9,b_){return[b_,b9];},b8).sort(s.Compare));};G.concat=function(b8){return a.Array.prototype.concat.apply([],G.ofSeq(b8));};G.create=function(b8,b9){var b_,b$,ca;b_=new a.Array(b8);for(b$=0,ca=b8-1;b$<=ca;b$++)b_[b$]=b9;return b_;};G.find=function(b8,b9){var b_;b_=G.tryFind(b8,b9);return b_==null?m.FailWith("KeyNotFoundException"):b_.$0;};G.init=function(b8,b9){var b_,b$,ca;if(b8<0)m.FailWith("Negative size given.");else null;b_=new a.Array(b8);for(b$=0,ca=b8-1;b$<=ca;b$++)b_[b$]=b9(b$);return b_;};G.forall=function(b8,b9){var b_,b$,ca,cb;b_=true;b$=0;cb=G.length(b9);while(b_&&b$<cb)if(b8(b9[b$]))b$=b$+1;else b_=false;return b_;};_6.convertTextNode=function(b8){var b9,b_,b$,ca,cb,cc;b9=null;b_=0;ca=b8.textContent;cb=new a.RegExp(g.TextHoleRE(),"g");while(b9=cb.exec(ca),b9!==null){b8.parentNode.insertBefore(self.document.createTextNode(_7.string(ca,{$:1,$0:b_},{$:1,$0:cb.lastIndex-G.get(b9,0).length-1})),b8);b_=cb.lastIndex;cc=self.document.createElement("span");cc.setAttribute("ws-replace",G.get(b9,1).toLowerCase());b8.parentNode.insertBefore(cc,b8);}cb.lastIndex=0;b8.textContent=_7.string(ca,{$:1,$0:b_},null);};_6.failNotLoaded=function(b8){b5.warn("Instantiating non-loaded template",b8);};_6.fillTextHole=function(b8,b9,b_){var b$;b$=b8.querySelector("[ws-replace]");return s.Equals(b$,null)?(b5.warn("Filling non-existent text hole",b_),null):(b$.parentNode.replaceChild(self.document.createTextNode(b9),b$),{$:1,$0:b$.getAttribute("ws-replace")});};_6.removeHolesExcept=function(b8,b9){function b_(b$){g.foreachNotPreserved(b8,"["+b$+"]",function(ca){if(!b9.Contains(ca.getAttribute(b$)))ca.removeAttribute(b$);});}b_("ws-attr");b_("ws-onafterrender");b_("ws-var");g.foreachNotPreserved(b8,"[ws-hole]",function(b$){if(!b9.Contains(b$.getAttribute("ws-hole"))){b$.removeAttribute("ws-hole");while(b$.hasChildNodes())b$.removeChild(b$.lastChild);}});g.foreachNotPreserved(b8,"[ws-replace]",function(b$){if(!b9.Contains(b$.getAttribute("ws-replace")))b$.parentNode.removeChild(b$);});g.foreachNotPreserved(b8,"[ws-on]",function(b$){b$.setAttribute("ws-on",_3.concat(" ",G.filter(function(ca){return b9.Contains(G.get(_3.SplitChars(ca,[":"],1),1));},_3.SplitChars(b$.getAttribute("ws-on"),[" "],1))));});g.foreachNotPreserved(b8,"[ws-attr-holes]",function(b$){var ca,cb,cc,cd,ce;ca=_3.SplitChars(b$.getAttribute("ws-attr-holes"),[" "],1);for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=G.get(ca,cb);b$.setAttribute(cd,(ce=new a.RegExp(g.TextHoleRE(),"g"),b$.getAttribute(cd).replace(ce,function(cf,cg){return b9.Contains(cg)?cf:"";})));}});};_6.fillInstanceAttrs=function(b8,b9){var b_,b$,ca,cb,cc;_6.convertAttrs(b9);b_=b9.nodeName.toLowerCase();b$=b8.querySelector("[ws-attr="+b_+"]");if(s.Equals(b$,null))b5.warn("Filling non-existent attr hole",b_);else{b$.removeAttribute("ws-attr");for(ca=0,cb=b9.attributes.length-1;ca<=cb;ca++){cc=b9.attributes.item(ca);if(cc.name==="class"&&b$.hasAttribute("class"))b$.setAttribute("class",b$.getAttribute("class")+" "+cc.nodeValue);else b$.setAttribute(cc.name,cc.nodeValue);}}};_6.mapHoles=function(b8,b9){function b_(b$){g.foreachNotPreserved(b8,"["+b$+"]",function(ca){var cb,cc;cb=(cc=null,[b9.TryGetValue(ca.getAttribute(b$).toLowerCase(),{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);if(cb[0])ca.setAttribute(b$,cb[1]);});}b_("ws-hole");b_("ws-replace");b_("ws-attr");b_("ws-onafterrender");b_("ws-var");g.foreachNotPreserved(b8,"[ws-on]",function(b$){b$.setAttribute("ws-on",_3.concat(" ",G.map(function(ca){var cb,cc,cd;cb=_3.SplitChars(ca,[":"],1);cc=(cd=null,[b9.TryGetValue(G.get(cb,1),{get:function(){return cd;},set:function(ce){cd=ce;}}),cd]);return cc[0]?G.get(cb,0)+":"+cc[1]:ca;},_3.SplitChars(b$.getAttribute("ws-on"),[" "],1))));});g.foreachNotPreserved(b8,"[ws-attr-holes]",function(b$){var ca,cb,cc;ca=_3.SplitChars(b$.getAttribute("ws-attr-holes"),[" "],1);for(cb=0,cc=ca.length-1;cb<=cc;cb++)(function(){var cd;function ce(cf,cg){var ch;ch=m.KeyValue(cg);return cf.replace(new a.RegExp("\\${"+ch[0]+"}","ig"),"${"+ch[1]+"}");}cd=G.get(ca,cb);return b$.setAttribute(cd,(((b4.Curried3(N.fold))(ce))(b$.getAttribute(cd)))(b9));}());});};_6.fill=function(b8,b9,b_){while(true)if(b8.hasChildNodes())b_=b9.insertBefore(b8.lastChild,b_);else return null;};_6.convertAttrs=function(b8){var b_,b$,ca,cb,cc,cd,ce,cf;function b9(cg){var ch;ch=b8.getAttribute(cg);if(ch===null);else b8.setAttribute(cg,ch.toLowerCase());}b_=b8.attributes;b$=[];ca=[];cb=[];for(cc=0,cd=b_.length-1;cc<=cd;cc++){ce=b_.item(cc);if(_3.StartsWith(ce.nodeName,"ws-on")&&ce.nodeName!=="ws-onafterrender"&&ce.nodeName!=="ws-on"){b$.push(ce.nodeName);ca.push(_7.string(ce.nodeName,{$:1,$0:"ws-on".length},null)+":"+ce.nodeValue.toLowerCase());}else!_3.StartsWith(ce.nodeName,"ws-")&&(new a.RegExp(g.TextHoleRE())).test(ce.nodeValue)?(ce.nodeValue=(cf=new a.RegExp(g.TextHoleRE(),"g"),ce.nodeValue.replace(cf,function(cg,ch){return"${"+ch.toLowerCase()+"}";})),cb.push(ce.nodeName)):void 0;}if(!(ca.length==0))b8.setAttribute("ws-on",_3.concat(" ",ca));if(!(cb.length==0))b8.setAttribute("ws-attr-holes",_3.concat(" ",cb));b9("ws-hole");b9("ws-replace");b9("ws-attr");b9("ws-onafterrender");b9("ws-var");G.iter(function(cg){b8.removeAttribute(cg);},b$);};_7.string=function(b8,b9,b_){return b9==null?b_!=null&&b_.$==1?b8.slice(0,b_.$0+1):"":b_==null?b8.slice(b9.$0):b8.slice(b9.$0,b_.$0+1);};_8.ParseHTMLIntoFakeRoot=function(b8){var b9,b_,b$,ca,cb;function cc(cd,ce){var cf;while(true)if(ce===0)return cd;else{cf=ce;cd=cd.lastChild;ce=cf-1;}}b9=self.document.createElement("div");return!_8.rhtml().test(b8)?(b9.appendChild(self.document.createTextNode(b8)),b9):(b_=(b$=_8.rtagName().exec(b8),s.Equals(b$,null)?"":G.get(b$,1).toLowerCase()),(ca=(cb=(_8.wrapMap())[b_],cb?cb:_8.defaultWrap()),(b9.innerHTML=ca[1]+b8.replace(_8.rxhtmlTag(),"<$1></$2>")+ca[2],cc(b9,ca[0]))));};_8.AddClass=function(b8,b9){var b_;b_=_8.getClass(b8);if(b_==="")_8.setClass(b8,b9);else!_8.clsRE(b9).test(b_)?_8.setClass(b8,b_+" "+b9):void 0;};_8.RemoveClass=function(b8,b9){var b_;_8.setClass(b8,(b_=_8.clsRE(b9),_8.getClass(b8).replace(b_,function(b$,ca,cb){return ca===""||cb===""?"":" ";})));};_8.rhtml=function(){bC.$cctor();return bC.rhtml;};_8.wrapMap=function(){bC.$cctor();return bC.wrapMap;};_8.defaultWrap=function(){bC.$cctor();return bC.defaultWrap;};_8.rxhtmlTag=function(){bC.$cctor();return bC.rxhtmlTag;};_8.rtagName=function(){bC.$cctor();return bC.rtagName;};_8.IterSelector=function(b8,b9,b_){var b$,ca,cb;b$=b8.querySelectorAll(b9);for(ca=0,cb=b$.length-1;ca<=cb;ca++)b_(b$[ca]);};_8.getClass=function(b8){return b8 instanceof a.SVGElement?b8.getAttribute("class"):b8.className;};_8.setClass=function(b8,b9){if(b8 instanceof a.SVGElement)b8.setAttribute("class",b9);else b8.className=b9;};_8.clsRE=function(b8){return new a.RegExp("(\\s+|^)"+b8+"(?:\\s+"+b8+")*(\\s+|$)","g");};_8.InsertAt=function(b8,b9,b_){var b$;if(!(b_.parentNode===b8&&b9===(b$=b_.nextSibling,s.Equals(b$,null)?null:b$)))b8.insertBefore(b_,b9);};_8.RemoveNode=function(b8,b9){if(b9.parentNode===b8)b8.removeChild(b9);};_8.ChildrenArray=function(b8){var b9,b_,b$;b9=[];for(b_=0,b$=b8.childNodes.length-1;b_<=b$;b_++)b9.push(b8.childNodes[b_]);return b9;};_9.Get=function(b8){return b8 instanceof a.Array?_9.ArrayEnumerator(b8):s.Equals(typeof b8,"string")?_9.StringEnumerator(b8):b8.GetEnumerator();};_9.ArrayEnumerator=function(b8){return new bz.New(0,null,function(b9){var b_;b_=b9.s;return b_<G.length(b8)&&(b9.c=G.get(b8,b_),b9.s=b_+1,true);},void 0);};_9.StringEnumerator=function(b8){return new bz.New(0,null,function(b9){var b_;b_=b9.s;return b_<b8.length&&(b9.c=b8[b_],b9.s=b_+1,true);},void 0);};_9.Get0=function(b8){return b8 instanceof a.Array?_9.ArrayEnumerator(b8):s.Equals(typeof b8,"string")?_9.StringEnumerator(b8):"GetEnumerator0"in b8?b8.GetEnumerator0():b8.GetEnumerator();};N.insufficient=function(){return m.FailWith("The input sequence has an insufficient number of elements.");};G.mapiInPlace=function(b8,b9){var b_,b$;for(b_=0,b$=b9.length-1;b_<=b$;b_++)b9[b_]=b8(b_,b9[b_]);return b9;};G.mapInPlace=function(b8,b9){var b_,b$;for(b_=0,b$=b9.length-1;b_<=b$;b_++)b9[b_]=b8(b9[b_]);};_=q.KeyCollection=b4.Class({GetEnumerator$1:function(){return _9.Get(N.map(function(b8){return b8.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},h,_);_.New=b4.Ctor(function(b8){h.New.call(this);this.d=b8;},_);$=e.DocElemNode=b4.Class({Equals:function(b8){return this.ElKey===b8.ElKey;},GetHashCode:function(){return this.ElKey;}},null,$);$.New=function(b8,b9,b_,b$,ca,cb){var cc;return new $((cc={Attr:b8,Children:b9,El:b$,ElKey:ca},(b4.SetOptional(cc,"Delimiters",b_),b4.SetOptional(cc,"Render",cb),cc)));};bb.get_UseAnimations=function(){return bt.UseAnimations();};bb.Play=function(b8){var b9;b9=null;return bs.Delay(function(){return bs.Bind(bb.Run(a.ignore,bt.Actions(b8)),function(){bt.Finalize(b8);return bs.Return(null);});});};bb.Append=function(b8,b9){return{$:0,$0:bw.Append(b8.$0,b9.$0)};};bb.Run=function(b8,b9){var b_;function b$(ca){function cb(cc){return function(cd){var ce;ce=cd-cc;b9.Compute(ce);b8();return ce<=b_?void a.requestAnimationFrame(function(cf){(cb(cc))(cf);}):ca();};}a.requestAnimationFrame(function(cc){(cb(cc))(cc);});}b_=b9.Duration;return b_===0?bs.Zero():bs.FromContinuations(function(ca,cb,cc){return b$.apply(null,[ca,cb,cc]);});};bb.Concat=function(b8){return{$:0,$0:bw.Concat(N.map(bt.List,b8))};};bb.get_Empty=function(){return{$:0,$0:bw.Empty()};};bc.BatchUpdatesEnabled=function(){bu.$cctor();return bu.BatchUpdatesEnabled;};be.StartProcessor=function(b8){var b9;function b_(){var b$;b$=null;return bs.Delay(function(){return bs.Bind(b8,function(){var ca;ca=b9[0];return ca===1?(b9[0]=0,bs.Zero()):ca===2?(b9[0]=1,b_()):bs.Zero();});});}b9=[0];return function(){var b$;b$=b9[0];if(b$===0){b9[0]=1;bs.Start(b_(),null);}else b$===1?b9[0]=2:void 0;};};bf=q.FSharpMap=b4.Class({Equals:function(b8){return this.get_Count()===b8.get_Count()&&N.forall2(s.Equals,this,b8);},get_IsEmpty:function(){return this.tree==null;},get_Count:function(){var b8;b8=this.tree;return b8==null?0:b8.Count;},GetEnumerator$1:function(){return _9.Get(N.map(function(b8){return{K:b8.Key,V:b8.Value};},bE.Enumerate(false,this.tree)));},GetHashCode:function(){return s.Hash(G.ofSeq(this));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();},CompareTo0:function(b8){return N.compareWith(s.Compare,this,b8);}},h,bf);bf.New=b4.Ctor(function(b8){bf.New$1.call(this,bv.fromSeq(b8));},bf);bf.New$1=b4.Ctor(function(b8){h.New.call(this);this.tree=b8;},bf);bg=R.ArrayStorage=b4.Class({SSet:function(b8){return G.ofSeq(b8);},SRemoveIf:function(b8,b9){return G.filter(function(b_){return!b8(b_);},b9);},SSetAt:function(b8,b9,b_){G.set(b_,b8,b9);return b_;},SAppend:function(b8,b9){b9.push(b8);return b9;},SInit:function(){return this.init;}},h,bg);bg.New=b4.Ctor(function(b8){h.New.call(this);this.init=b8;},bg);bh.ParseHash=function(b8){var b9,b_,b$,ca;b9=bh.NoHash(b8);b_=(b$=b9.indexOf("?"),b$===-1?[b9,""]:[_7.string(b9,null,{$:1,$0:b$-1}),_7.string(b9,{$:1,$0:b$+1},null)]);ca=b_[0];return{$:0,$0:bw.FromArray(ca===""?[]:G.map(function(cb){return a.decodeURIComponent(cb);},_3.SplitChars(ca,["/"],0))),$1:Q.OfArray(G.map(function(cb){var cc;cc=cb.indexOf("=");return cc===-1?[a.decodeURIComponent(cb),""]:[a.decodeURIComponent(_7.string(cb,null,{$:1,$0:cc-1})),a.decodeURIComponent(_7.string(cb,{$:1,$0:cc+1},null))];},_3.SplitChars(b_[1],["&"],0)))};};bh.ToList=function(b8){return[v.ofArray(bw.ToArray(b8.$0)),b8.$1];};bh.MakeHash=function(b8){var b9,b_;b9=b8.$1;b_=_3.concat("/",G.map(function(b$){return a.encodeURIComponent(b$);},bw.ToArray(b8.$0)));return b9.get_IsEmpty()?b_:b_+"?"+_3.concat("&",N.map(function(b$){var ca;ca=m.KeyValue(b$);return a.encodeURIComponent(ca[0])+"="+a.encodeURIComponent(ca[1]);},b9));};bh.FromList=function(b8,b9){return{$:0,$0:bw.FromArray(G.ofList(b8)),$1:b9};};bh.SameHash=function(b8,b9){return bh.NoHash(b8)===bh.NoHash(b9);};bh.NoHash=function(b8){return _3.StartsWith(b8,"#")?b8.substring(1):b8;};bi.Int=function(){bi.set_counter(bi.counter()+1);return bi.counter();};bi.set_counter=function(b8){bH.$cctor();bH.counter=b8;};bi.counter=function(){bH.$cctor();return bH.counter;};bi.Id=function(){bi.set_counter(bi.counter()+1);return"uid"+a.String(bi.counter());};bk=bj.attr=b4.Class({},h,bk);V.Obsolete=function(b8){var b9,b_,b$,ca,cb;b_=b8.s;if(b_==null||(b_!=null&&b_.$==2?(b9=b_.$1,false):b_!=null&&b_.$==3?(b9=b_.$1,false):true))void 0;else{b8.s=null;for(b$=0,ca=G.length(b9)-1;b$<=ca;b$++){cb=G.get(b9,b$);if(typeof cb=="object")(function(cc){V.Obsolete(cc);}(cb));else cb();}}};V.New=function(b8){return{s:b8};};bl.ofSeqNonCopying=function(b8){var b9,b_;if(b8 instanceof a.Array)return b8;else if(b8 instanceof w)return G.ofList(b8);else if(b8===null)return[];else{b9=[];b_=_9.Get(b8);try{while(b_.MoveNext())b9.push(b_.Current());return b9;}finally{if(typeof b_=="object"&&"Dispose"in b_)b_.Dispose();}}};bl.TreeReduce=function(b8,b9,b_){var b$;function ca(cb){return function(cc){var cd,ce;return cc<=0?b8:cc===1&&(cb>=0&&cb<b$)?G.get(b_,cb):(ce=cc/2>>0,b9((ca(cb))(ce),(ca(cb+ce))(cc-ce)));};}b$=G.length(b_);return(ca(0))(b$);};bl.mapInPlace=function(b8,b9){var b_,b$;for(b_=0,b$=b9.length-1;b_<=b$;b_++)b9[b_]=b8(b9[b_]);return b9;};bl.MapTreeReduce=function(b8,b9,b_,b$){var ca;function cb(cc){return function(cd){var ce,cf;return cd<=0?b9:cd===1&&(cc>=0&&cc<ca)?b8(G.get(b$,cc)):(cf=cd/2>>0,b_((cb(cc))(cf),(cb(cc+cf))(cd-cf)));};}ca=G.length(b$);return(cb(0))(ca);};bm.$cctor=function(){bm.$cctor=a.ignore;bm.initialized=new r.New$5();};bm=E.TemplateInitializer=b4.Class({},h,bm);bm.GetOrAddHoleFor=function(b8,b9,b_){var b$,ca,cb,cc;bm.$cctor();b$=bm.GetHolesFor(b8);ca=(cb=null,[b$.TryGetValue(b9,{get:function(){return cb;},set:function(cd){cb=cd;}}),cb]);return ca[0]?ca[1]:(cc=b_(),(b$.set_Item(b9,cc),cc));};bm.GetHolesFor=function(b8){var b9,b_,b$;bm.$cctor();b9=(b_=null,[bm.initialized.TryGetValue(b8,{get:function(){return b_;},set:function(ca){b_=ca;}}),b_]);return b9[0]?b9[1]:(b$=new r.New$5(),(bm.initialized.set_Item(b8,b$),b$));};bo.New=function(b8,b9,b_,b$){var ca;ca={DynElem:b8,DynFlags:b9,DynNodes:b_};b4.SetOptional(ca,"OnAfterRender",b$);return ca;};bq.New=function(b8,b9){return{PreviousNodes:b8,Top:b9};};br.get_Empty=function(){return{$:0,$0:new M.New$3()};};br.FindAll=function(b8){var b9;function b_(cb,cc){var cd,ce,cf,cg,ch;while(true)switch(cb){case 0:if(cc!=null&&cc.$==0){ce=cc.$1;cf=cc.$0;b_(0,cf);cc=ce;}else if(cc!=null&&cc.$==1){cg=cc.$0;cc=cg;cb=1;}else if(cc!=null&&cc.$==2){ch=cc.$0;cc=ch.Current;}else return cc!=null&&cc.$==6?(cd=cc.$0.Holes,(function(ci){return function(cj){G.iter(ci,cj);};}(ca))(cd)):null;break;case 1:b9.push(cc);cc=cc.Children;cb=0;break;}}function b$(cb){return b_(0,cb);}function ca(cb){return b_(1,cb);}b9=[];b$(b8);return{$:0,$0:new M.New$2(b9)};};br.Filter=function(b8,b9){return{$:0,$0:bQ.Filter(b8,b9.$0)};};br.Except=function(b8,b9){return{$:0,$0:bQ.Except(b8.$0,b9.$0)};};br.ToArray=function(b8){return bQ.ToArray(b8.$0);};br.Intersect=function(b8,b9){return{$:0,$0:bQ.Intersect(b8.$0,b9.$0)};};bs.Delay=function(b8){return function(b9){try{(b8(null))(b9);}catch(b_){b9.k({$:1,$0:b_});}};};bs.Bind=function(b8,b9){return bs.checkCancel(function(b_){b8(bN.New(function(b$){var ca;if(b$.$==0){ca=b$.$0;bs.scheduler().Fork(function(){try{(b9(ca))(b_);}catch(cb){b_.k({$:1,$0:cb});}});}else bs.scheduler().Fork(function(){b_.k(b$);});},b_.ct));});};bs.Zero=function(){bO.$cctor();return bO.Zero;};bs.Start=function(b8,b9){var b_,b$;b_=(b$=(bs.defCTS())[0],b9==null?b$:b9.$0);bs.scheduler().Fork(function(){if(!b_.c)b8(bN.New(function(ca){if(ca.$==1)bs.UncaughtAsyncError(ca.$0);},b_));});};bs.Return=function(b8){return function(b9){b9.k({$:0,$0:b8});};};bs.scheduler=function(){bO.$cctor();return bO.scheduler;};bs.checkCancel=function(b8){return function(b9){if(b9.ct.c)bs.cancel(b9);else b8(b9);};};bs.defCTS=function(){bO.$cctor();return bO.defCTS;};bs.UncaughtAsyncError=function(b8){b5.log("WebSharper: Uncaught asynchronous exception",b8);};bs.FromContinuations=function(b8){return function(b9){var b_;function b$(ca){if(b_[0])m.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{b_[0]=true;bs.scheduler().Fork(ca);}}b_=[false];b8(function(ca){b$(function(){b9.k({$:0,$0:ca});});},function(ca){b$(function(){b9.k({$:1,$0:ca});});},function(ca){b$(function(){b9.k({$:2,$0:ca});});});};};bs.cancel=function(b8){b8.k({$:2,$0:new bY.New(b8.ct)});};bt.UseAnimations=function(){bD.$cctor();return bD.UseAnimations;};bt.Actions=function(b8){return bt.ConcatActions(G.choose(function(b9){return b9.$==1?{$:1,$0:b9.$0}:null;},bw.ToArray(b8.$0)));};bt.Finalize=function(b8){G.iter(function(b9){if(b9.$==0)b9.$0();},bw.ToArray(b8.$0));};bt.ConcatActions=function(b8){var b9,b_,b$,ca;b9=bl.ofSeqNonCopying(b8);b_=G.length(b9);return b_===0?bt.Const():b_===1?G.get(b9,0):(b$=N.max(N.map(function(cb){return cb.Duration;},b9)),(ca=G.map(function(cb){return bt.Prolong(b$,cb);},b9),bt.Def(b$,function(cb){G.iter(function(cc){cc.Compute(cb);},ca);})));};bt.List=function(b8){return b8.$0;};bt.Const=function(b8){return bt.Def(0,function(){return b8;});};bt.Def=function(b8,b9){return{Compute:b9,Duration:b8};};bt.Prolong=function(b8,b9){var b_,b$,ca;b_=b9.Compute;b$=b9.Duration;ca=bZ.Create(function(){return b9.Compute(b9.Duration);});return{Compute:function(cb){return cb>=b$?ca.f():b_(cb);},Duration:b8};};bu.$cctor=function(){bu.$cctor=a.ignore;bu.BatchUpdatesEnabled=true;};bv.fromSeq=function(b8){var b9;b9=G.ofSeq(N.map(function(b_){return bG.New(b_[0],b_[1]);},N.distinctBy(function(b_){return b_[0];},N.rev(b8))));G.sortInPlace(b9);return bE.Build(b9,0,b9.length-1);};bw.FromArray=function(b8){var b9;b9=b8.length;return b9===0?{$:0}:b9===1?{$:1,$0:G.get(b8,0)}:{$:3,$0:b8.slice()};};bw.ToArray=function(b8){var b9;function b_(b$){var ca,cb;while(true)if(b$.$==1)return b9.push(b$.$0);else if(b$.$==2){ca=b$.$1;cb=b$.$0;b_(cb);b$=ca;}else return b$.$==3?G.iter(function(cc){b9.push(cc);},b$.$0):null;}b9=[];b_(b8);return b9.slice(0);};bw.Append=function(b8,b9){return b8.$==0?b9:b9.$==0?b8:{$:2,$0:b8,$1:b9};};bw.Concat=function(b8){var b9;b9=bl.ofSeqNonCopying(b8);return bl.TreeReduce(bw.Empty(),bw.Append,b9);};bw.Empty=function(){b0.$cctor();return b0.Empty;};bx=e.DynamicAttrNode=b4.Class({NGetExitAnim:function(b8){return bb.get_Empty();},NGetEnterAnim:function(b8){return bb.get_Empty();},NGetChangeAnim:function(b8){return bb.get_Empty();},NChanged:function(){return this.updates;},NSync:function(b8){if(this.dirty){(this.push(b8))(this.value);this.dirty=false;}}},h,bx);bx.New=b4.Ctor(function(b8,b9){var b_;b_=this;h.New.call(this);this.push=b9;this.value=void 0;this.dirty=false;this.updates=J.Map(function(b$){b_.value=b$;b_.dirty=true;},b8);},bx);by=e.CheckedInput=b4.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,by);bz=_9.T=b4.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},h,bz);bz.New=b4.Ctor(function(b8,b9,b_,b$){h.New.call(this);this.s=b8;this.c=b9;this.n=b_;this.d=b$;},bz);bA.BoolCheckedApply=function(){bI.$cctor();return bI.BoolCheckedApply;};bA.StringApply=function(){bI.$cctor();return bI.StringApply;};bA.ApplyValue=function(b8,b9,b_,b$,ca){return[b$(function(cb){function cc(){b_.UpdateMaybe(function(cd){var ce,cf;ce=b8(cb);return ce!=null&&ce.$==1&&(!s.Equals(ce.$0,cd)&&(cf=[ce,ce.$0],true))?cf[0]:null;});}cb.addEventListener("change",cc);cb.addEventListener("input",cc);cb.addEventListener("keypress",cc);}),ca(function(cb){return function(cc){var cd,ce;cd=b8(cb);return cd!=null&&cd.$==1&&(s.Equals(cd.$0,cc)&&(ce=cd.$0,true))?null:b9(cb,cc);};})];};bA.StringSet=function(){bI.$cctor();return bI.StringSet;};bA.StringGet=function(){bI.$cctor();return bI.StringGet;};bA.IntSetUnchecked=function(){bI.$cctor();return bI.IntSetUnchecked;};bA.IntGetUnchecked=function(){bI.$cctor();return bI.IntGetUnchecked;};bA.IntSetChecked=function(){bI.$cctor();return bI.IntSetChecked;};bA.IntGetChecked=function(){bI.$cctor();return bI.IntGetChecked;};bA.FloatSetUnchecked=function(){bI.$cctor();return bI.FloatSetUnchecked;};bA.FloatGetUnchecked=function(){bI.$cctor();return bI.FloatGetUnchecked;};bA.FloatSetChecked=function(){bI.$cctor();return bI.FloatSetChecked;};bA.FloatGetChecked=function(){bI.$cctor();return bI.FloatGetChecked;};bA.IntApplyChecked=function(){bI.$cctor();return bI.IntApplyChecked;};bA.IntApplyUnchecked=function(){bI.$cctor();return bI.IntApplyUnchecked;};bA.FloatApplyChecked=function(){bI.$cctor();return bI.FloatApplyChecked;};bA.FloatApplyUnchecked=function(){bI.$cctor();return bI.FloatApplyUnchecked;};bB=e.Elt=b4.Class({},i,bB);bB.New=function(b8,b9,b_){var b$,ca;b$=P.CreateElemNode(b8,b9,b_.docNode);ca=bJ.Create(b_.updates);return new bB.New$1({$:1,$0:b$},J.Map2Unit(_0.Updates(b$.Attr),ca.v),b8,ca);};bB.TreeNode=function(b8,b9){var b_,b$;function ca(cb){return cb[1];}b_=bJ.Create(b9);return new bB.New$1({$:6,$0:b8},J.Map2Unit((b$=G.map(function(cb){return _0.Updates(ca(cb));},b8.Attrs),bl.TreeReduce(J.Const(),J.Map2Unit,b$)),b_.v),G.get(b8.Els,0),b_);};bB.New$1=b4.Ctor(function(b8,b9,b_,b$){i.New.call(this,b8,b9);this.docNode$1=b8;this.updates$1=b9;this.elt=b_;this.rvUpdates=b$;},bB);bC.$cctor=function(){var b8;bC.$cctor=a.ignore;bC.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bC.rtagName=new a.RegExp("<([\\w:]+)");bC.rhtml=new a.RegExp("<|&#?\\w+;");bC.wrapMap=(b8=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:b8,tbody:b8,tfoot:b8,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bC.defaultWrap=[0,"",""];};bD.$cctor=function(){bD.$cctor=a.ignore;bD.CubicInOut=bM.Custom(function(b8){var b9;b9=b8*b8;return 3*b9-2*(b9*b8);});bD.UseAnimations=true;};bF.New=function(b8,b9,b_,b$,ca){return{Node:b8,Left:b9,Right:b_,Height:b$,Count:ca};};bG=q.Pair=b4.Class({Equals:function(b8){return s.Equals(this.Key,b8.Key);},GetHashCode:function(){return s.Hash(this.Key);},CompareTo0:function(b8){return s.Compare(this.Key,b8.Key);}},null,bG);bG.New=function(b8,b9){return new bG({Key:b8,Value:b9});};bE.OfSeq=function(b8){var b9;b9=G.ofSeq(N.distinct(b8));G.sortInPlace(b9);return bE.Build(b9,0,b9.length-1);};bE.Build=function(b8,b9,b_){var b$,ca,cb;return b_-b9+1<=0?null:(b$=(b9+b_)/2>>0,(ca=bE.Build(b8,b9,b$-1),(cb=bE.Build(b8,b$+1,b_),bE.Branch(G.get(b8,b$),ca,cb))));};bE.Branch=function(b8,b9,b_){var b$,ca;return bF.New(b8,b9,b_,1+(b$=b9==null?0:b9.Height,(ca=b_==null?0:b_.Height,s.Compare(b$,ca)===1?b$:ca)),1+(b9==null?0:b9.Count)+(b_==null?0:b_.Count));};bE.Enumerate=function(b8,b9){function b_(b$,ca){var cb;while(true)if(b$==null)return ca.$==1?{$:1,$0:[ca.$0[0],[ca.$0[1],ca.$1]]}:null;else if(b8){cb=b$;b$=cb.Right;ca=new w({$:1,$0:[cb.Node,cb.Left],$1:ca});}else{cb=b$;b$=cb.Left;ca=new w({$:1,$0:[cb.Node,cb.Right],$1:ca});}}return N.unfold(function(b$){return b_(b$[0],b$[1]);},[b9,w.Empty]);};bH.$cctor=function(){bH.$cctor=a.ignore;bH.counter=0;};bI.$cctor=function(){var b8,b9,b_,b$,ca,cb,cc,cd,ce,cf;bI.$cctor=a.ignore;bI.EmptyAttr=null;bI.BoolCheckedApply=b4.Curried3(function(cg,ch,ci){return[ch(function(cj){cj.addEventListener("change",function(){return!s.Equals(cg.Get(),cj.checked)?cg.Set(cj.checked):null;});}),ci(function(cj){return function(ck){cj.checked=ck;};})];});bI.StringSet=function(cg){return function(ch){cg.value=ch;};};bI.StringGet=function(cg){return{$:1,$0:cg.value};};bI.StringApply=(b8=bA.StringGet(),(b9=bA.StringSet(),b4.Curried(bA.ApplyValue,3,[b8,function(cg,ch){return(b9(cg))(ch);}])));bI.IntSetUnchecked=function(cg){return function(ch){cg.value=a.String(ch);};};bI.IntGetUnchecked=function(cg){var ch,ci;ch=cg.value;return bS.isBlank(ch)?{$:1,$0:0}:(ci=+ch,ci!==ci>>0?null:{$:1,$0:ci});};bI.IntApplyUnchecked=(b_=bA.IntGetUnchecked(),(b$=bA.IntSetUnchecked(),b4.Curried(bA.ApplyValue,3,[b_,function(cg,ch){return(b$(cg))(ch);}])));bI.IntSetChecked=function(cg){return function(ch){var ci;ci=ch.get_Input();return cg.value!==ci?void(cg.value=ci):null;};};bI.IntGetChecked=function(cg){var ch,ci,cj;ch=cg.value;return{$:1,$0:bS.isBlank(ch)?(cg.checkValidity?cg.checkValidity():true)?new by({$:2,$0:ch}):new by({$:1,$0:ch}):(ci=(cj=0,[S.TryParseInt32(ch,{get:function(){return cj;},set:function(ck){cj=ck;}}),cj]),ci[0]?new by({$:0,$0:ci[1],$1:ch}):new by({$:1,$0:ch}))};};bI.IntApplyChecked=(ca=bA.IntGetChecked(),(cb=bA.IntSetChecked(),b4.Curried(bA.ApplyValue,3,[ca,function(cg,ch){return(cb(cg))(ch);}])));bI.FloatSetUnchecked=function(cg){return function(ch){cg.value=a.String(ch);};};bI.FloatGetUnchecked=function(cg){var ch,ci;ch=cg.value;return bS.isBlank(ch)?{$:1,$0:0}:(ci=+ch,a.isNaN(ci)?null:{$:1,$0:ci});};bI.FloatApplyUnchecked=(cc=bA.FloatGetUnchecked(),(cd=bA.FloatSetUnchecked(),b4.Curried(bA.ApplyValue,3,[cc,function(cg,ch){return(cd(cg))(ch);}])));bI.FloatSetChecked=function(cg){return function(ch){var ci;ci=ch.get_Input();return cg.value!==ci?void(cg.value=ci):null;};};bI.FloatGetChecked=function(cg){var ch,ci;ch=cg.value;return{$:1,$0:bS.isBlank(ch)?(cg.checkValidity?cg.checkValidity():true)?new by({$:2,$0:ch}):new by({$:1,$0:ch}):(ci=+ch,a.isNaN(ci)?new by({$:1,$0:ch}):new by({$:0,$0:ci,$1:ch}))};};bI.FloatApplyChecked=(ce=bA.FloatGetChecked(),(cf=bA.FloatSetChecked(),b4.Curried(bA.ApplyValue,3,[ce,function(cg,ch){return(cf(cg))(ch);}])));};bJ=e.Updates=b4.Class({},null,bJ);bJ.Create=function(b8){var b9;b9=null;b9=bJ.New(b8,null,function(){var b_;b_=b9.s;return b_===null?(b_=V.Copy(b9.c()),b9.s=b_,V.WhenObsoleteRun(b_,function(){b9.s=null;}),b_):b_;});return b9;};bJ.New=function(b8,b9,b_){return new bJ({c:b8,s:b9,v:b_});};bK.concat=function(b8){var b9,b_;b9=[];for(var b$ in b8)b9.push.apply(b9,b8[b$]);return b9;};bL=bs.Scheduler=b4.Class({Fork:function(b8){var b9;b9=this;this.robin.push(b8);if(this.idle){this.idle=false;a.setTimeout(function(){b9.tick();},0);}},tick:function(){var b8,b9,b_;b9=this;b_=b7.now();b8=true;while(b8)if(this.robin.length===0){this.idle=true;b8=false;}else{(this.robin.shift())();b7.now()-b_>40?(a.setTimeout(function(){b9.tick();},0),b8=false):void 0;}}},h,bL);bL.New=b4.Ctor(function(){h.New.call(this);this.idle=true;this.robin=[];},bL);bM=e.Easing=b4.Class({},h,bM);bM.Custom=function(b8){return new bM.New(b8);};bM.New=b4.Ctor(function(b8){h.New.call(this);this.transformTime=b8;},bM);bN.New=function(b8,b9){return{k:b8,ct:b9};};bO.$cctor=function(){bO.$cctor=a.ignore;bO.noneCT=bP.New(false,[]);bO.scheduler=new bL.New();bO.defCTS=[new bT.New()];bO.Zero=bs.Return();bO.GetCT=function(b8){b8.k({$:0,$0:b8.ct});};};bP.New=function(b8,b9){return{c:b8,r:b9};};bQ.Filter=function(b8,b9){return new M.New$2(G.filter(b8,bQ.ToArray(b9)));};bQ.Except=function(b8,b9){var b_;b_=new M.New$2(bQ.ToArray(b9));b_.ExceptWith(bQ.ToArray(b8));return b_;};bQ.ToArray=function(b8){var b9;b9=G.create(b8.get_Count(),void 0);b8.CopyTo(b9);return b9;};bQ.Intersect=function(b8,b9){var b_;b_=new M.New$2(bQ.ToArray(b8));b_.IntersectWith(bQ.ToArray(b9));return b_;};bR.Clear=function(b8){b8.splice(0,G.length(b8));};bS.isBlank=function(b8){return _3.forall(bV.IsWhiteSpace,b8);};bT=d.CancellationTokenSource=b4.Class({},h,bT);bT.New=b4.Ctor(function(){h.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bT);bU.Children=function(b8,b9){var b_,b$,ca;if(b9!=null&&b9.$==1){ca=[];b_=b9.$0[0].nextSibling;while(b_!==b9.$0[1]){ca.push(b_);b_=b_.nextSibling;}return{$:0,$0:ca};}else return{$:0,$0:G.init(b8.childNodes.length,(b$=b8.childNodes,function(cb){return b$[cb];}))};};bU.Except=function(b8,b9){var b_;b_=b8.$0;return{$:0,$0:G.filter(function(b$){return G.forall(function(ca){return!(b$===ca);},b_);},b9.$0)};};bU.Iter=function(b8,b9){G.iter(b8,b9.$0);};bU.DocChildren=function(b8){var b9;function b_(b$){var ca,cb,cc,cd;while(true){if(b$!=null&&b$.$==2){cb=b$.$0;b$=cb.Current;}else if(b$!=null&&b$.$==1)return b9.push(b$.$0.El);else if(b$==null)return null;else if(b$!=null&&b$.$==5)return b9.push(b$.$0);else if(b$!=null&&b$.$==4)return b9.push(b$.$0.Text);else if(b$!=null&&b$.$==6){ca=b$.$0.Els;return(function(ce){return function(cf){G.iter(ce,cf);};}(function(ce){if(ce==null||ce.constructor===_5)b_(ce);else b9.push(ce);}))(ca);}else{cc=b$.$1;cd=b$.$0;b_(cd);b$=cc;}}}b9=[];b_(b8.Children);return{$:0,$0:bl.ofSeqNonCopying(b9)};};bV.IsWhiteSpace=function(b8){return b8.match(new a.RegExp("\\s"))!==null;};S.TryParse=function(b8,b9,b_,b$){var ca,cb;ca=+b8;cb=ca===ca-ca%1&&ca>=b9&&ca<=b_;if(cb)b$.set(ca);return cb;};bW=q.ValueCollection=b4.Class({GetEnumerator$1:function(){return _9.Get(N.map(function(b8){return b8.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},h,bW);bW.New=b4.Ctor(function(b8){h.New.call(this);this.d=b8;},bW);bY=d.OperationCanceledException=b4.Class({},bX,bY);bY.New=b4.Ctor(function(b8){bY.New$1.call(this,"The operation was canceled.",null,b8);},bY);bY.New$1=b4.Ctor(function(b8,b9,b_){this.message=b8;this.inner=b9;_5.setPrototypeOf(this,bY.prototype);this.ct=b_;},bY);bZ.Create=function(b8){return b2.New(false,b8,bZ.forceLazy);};bZ.forceLazy=function(){var b8;b8=this.v();this.c=true;this.v=b8;this.f=bZ.cachedLazy;return b8;};bZ.cachedLazy=function(){return this.v;};b0.$cctor=function(){b0.$cctor=a.ignore;b0.Empty={$:0};};b2.New=function(b8,b9,b_){return{c:b8,v:b9,f:b_};};b4.OnLoad(function(){c.Main();});}(self));


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
